(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[2],{

/***/ "./node_modules/@aws-amplify/ui-components/dist/esm-es5/amplify-confirm-sign-in_7.entry.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@aws-amplify/ui-components/dist/esm-es5/amplify-confirm-sign-in_7.entry.js ***!
  \*************************************************************************************************/
/*! exports provided: amplify_confirm_sign_in, amplify_confirm_sign_up, amplify_forgot_password, amplify_require_new_password, amplify_sign_in, amplify_sign_up, amplify_verify_contact */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"amplify_confirm_sign_in\", function() { return AmplifyConfirmSignIn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"amplify_confirm_sign_up\", function() { return AmplifyConfirmSignUp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"amplify_forgot_password\", function() { return AmplifyForgotPassword; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"amplify_require_new_password\", function() { return AmplifyRequireNewPassword; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"amplify_sign_in\", function() { return AmplifySignIn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"amplify_sign_up\", function() { return AmplifySignUp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"amplify_verify_contact\", function() { return AmplifyVerifyContact; });\n/* harmony import */ var _index_39969785_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-39969785.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/index-39969785.js\");\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aws-amplify/core */ \"./node_modules/@aws-amplify/core/lib-esm/index.js\");\n/* harmony import */ var _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./auth-types-78df304e.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-types-78df304e.js\");\n/* harmony import */ var _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aws-amplify/auth */ \"./node_modules/@aws-amplify/auth/lib-esm/index.js\");\n/* harmony import */ var _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Translations-71acc661.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/Translations-71acc661.js\");\n/* harmony import */ var _constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./constants-d1abe7de.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/constants-d1abe7de.js\");\n/* harmony import */ var _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./helpers-03bb6a38.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/helpers-03bb6a38.js\");\n/* harmony import */ var _auth_helpers_442d4bea_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./auth-helpers-442d4bea.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-442d4bea.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArrays = (undefined && undefined.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\n\n\n\n\n\n\n\n\nvar AmplifyConfirmSignIn = /** @class */ (function () {\n    function class_1(hostRef) {\n        var _this = this;\n        Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"r\"])(this, hostRef);\n        /** Fires when confirm sign in form is submitted */\n        this.handleSubmit = function (event) { return _this.confirm(event); };\n        /** Used for header text in confirm sign in component */\n        this.headerText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SMS_CODE;\n        /** Used for the submit button text in confirm sign in component */\n        this.submitButtonText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM;\n        /** Auth state change handler for this component */\n        this.handleAuthStateChange = _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"d\"];\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = [\n            {\n                type: 'code',\n                required: true,\n                handleInputChange: function (event) { return _this.handleCodeChange(event); },\n            },\n        ];\n        /** The MFA option to confirm with */\n        this.mfaOption = _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"M\"].SMS;\n        /* Whether or not the confirm-sign-in component is loading */\n        this.loading = false;\n    }\n    class_1.prototype.componentWillLoad = function () {\n        if (this.user && this.user['challengeName'] === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"C\"].SoftwareTokenMFA) {\n            this.mfaOption = _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"M\"].TOTP;\n            // If header text is using default use TOTP string\n            if (this.headerText === _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SMS_CODE) {\n                this.headerText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_TOTP_CODE;\n            }\n        }\n    };\n    class_1.prototype.handleCodeChange = function (event) {\n        this.code = event.target.value;\n    };\n    class_1.prototype.confirm = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var mfaType, error_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        mfaType = this.user['challengeName'] === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"C\"].SoftwareTokenMFA ? _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"C\"].SoftwareTokenMFA : null;\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].confirmSignIn !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        this.loading = true;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 4, 5, 6]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].confirmSignIn(this.user, this.code, mfaType)];\n                    case 2:\n                        _a.sent();\n                        return [4 /*yield*/, Object(_auth_helpers_442d4bea_js__WEBPACK_IMPORTED_MODULE_7__[\"c\"])(this.user, this.handleAuthStateChange)];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 6];\n                    case 4:\n                        error_1 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_1);\n                        return [3 /*break*/, 6];\n                    case 5:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 6: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_1.prototype.render = function () {\n        var _this = this;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"H\"], null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.headerText), handleSubmit: this.handleSubmit, submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.submitButtonText), loading: this.loading, secondaryFooterContent: Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignIn); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].BACK_TO_SIGN_IN))) }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-auth-fields\", { formFields: this.formFields }))));\n    };\n    return class_1;\n}());\nvar AmplifyConfirmSignUp = /** @class */ (function () {\n    function class_2(hostRef) {\n        var _this = this;\n        Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"r\"])(this, hostRef);\n        /** Fires when sign up form is submitted */\n        this.handleSubmit = function (event) { return _this.confirmSignUp(event); };\n        /** Used for header text in confirm sign up component */\n        this.headerText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_HEADER_TEXT;\n        /** Used for the submit button text in confirm sign up component */\n        this.submitButtonText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_SUBMIT_BUTTON_TEXT;\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = [];\n        /** Auth state change handler for this components\n         * e.g. SignIn -> 'Create Account' link -> SignUp\n         */\n        this.handleAuthStateChange = _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"d\"];\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        this.loading = false;\n        this.userInput = this.user ? this.user.username : null;\n        this._signUpAttrs = this.user && this.user.signUpAttrs ? this.user.signUpAttrs : null;\n        this.newFormFields = [];\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"h\"],\n            phoneNumberValue: null,\n        };\n    }\n    class_2.prototype.componentWillLoad = function () {\n        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"c\"])(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_2.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_2.prototype.buildDefaultFormFields = function () {\n        var _this = this;\n        this.newFormFields = [\n            {\n                type: \"\" + this.usernameAlias,\n                required: true,\n                handleInputChange: this.handleFormFieldInputChange(\"\" + this.usernameAlias),\n                value: this.userInput,\n                disabled: this.userInput ? true : false,\n            },\n            {\n                type: 'code',\n                label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_CODE_LABEL),\n                placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_CODE_PLACEHOLDER),\n                required: true,\n                hint: (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_LOST_CODE), ' ', Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.resendConfirmCode(); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_RESEND_CODE)))),\n                handleInputChange: this.handleFormFieldInputChange('code'),\n            },\n        ];\n    };\n    class_2.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            var newFields_1 = [];\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                if (newField.type === 'code') {\n                    newField['hint'] = Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"i\"])(newField) ? (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_LOST_CODE), ' ', Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.resendConfirmCode(); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_RESEND_CODE)))) : (newField['hint']);\n                }\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                newFields_1.push(newField);\n            });\n            this.newFormFields = newFields_1;\n        }\n    };\n    class_2.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n            case 'email':\n                return function (event) { return (_this.userInput = event.target.value); };\n            case 'phone_number':\n                return function (event) { return Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"h\"])(event, _this.phoneNumber); };\n            case 'code':\n                return function (event) { return (_this.code = event.target.value); };\n            default:\n                return;\n        }\n    };\n    class_2.prototype.setFieldValue = function (field) {\n        switch (field.type) {\n            case 'username':\n            case 'email':\n                if (field.value === undefined) {\n                    this.userInput = '';\n                }\n                else {\n                    this.userInput = field.value;\n                }\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n        }\n    };\n    class_2.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    class_2.prototype.resendConfirmCode = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var error_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].resendSignUp !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        if (!this.userInput)\n                            throw new Error('Username can not be empty');\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].resendSignUp(this.userInput)];\n                    case 2:\n                        _a.sent();\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].ConfirmSignUp);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_2 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_2);\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    // TODO: Add validation\n    // TODO: Prefix\n    class_2.prototype.confirmSignUp = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var confirmSignUpResult, error_3;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].confirmSignUp !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        this.loading = true;\n                        switch (this.usernameAlias) {\n                            case 'phone_number':\n                                try {\n                                    this.userInput = Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"b\"])(this.phoneNumber);\n                                }\n                                catch (error) {\n                                    Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error);\n                                }\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 6, 7, 8]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].confirmSignUp(this.userInput, this.code)];\n                    case 2:\n                        confirmSignUpResult = _a.sent();\n                        if (!confirmSignUpResult) {\n                            throw new Error(_aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CONFIRM_SIGN_UP_FAILED));\n                        }\n                        if (!(this._signUpAttrs && this._signUpAttrs.password && this._signUpAttrs.password !== '')) return [3 /*break*/, 4];\n                        // Auto sign in user if password is available from previous workflow\n                        return [4 /*yield*/, Object(_auth_helpers_442d4bea_js__WEBPACK_IMPORTED_MODULE_7__[\"h\"])(this.userInput, this._signUpAttrs.password, this.handleAuthStateChange)];\n                    case 3:\n                        // Auto sign in user if password is available from previous workflow\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignIn);\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 8];\n                    case 6:\n                        error_3 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_3);\n                        return [3 /*break*/, 8];\n                    case 7:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 8: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_2.prototype.render = function () {\n        var _this = this;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"H\"], null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.headerText), submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.submitButtonText), handleSubmit: this.handleSubmit, secondaryFooterContent: Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignIn); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].BACK_TO_SIGN_IN)))) }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-auth-fields\", { formFields: this.newFormFields }))));\n    };\n    Object.defineProperty(class_2, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_2;\n}());\nvar logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"Logger\"]('ForgotPassword');\nvar AmplifyForgotPassword = /** @class */ (function () {\n    function class_3(hostRef) {\n        var _this = this;\n        Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"r\"])(this, hostRef);\n        /** The header text of the forgot password section */\n        this.headerText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].RESET_YOUR_PASSWORD;\n        /** The text displayed inside of the send code button for the form */\n        this.sendButtonText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SEND_CODE;\n        /** The text displayed inside of the submit button for the form */\n        this.submitButtonText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SUBMIT;\n        /** The form fields displayed inside of the forgot password form */\n        this.formFields = [];\n        /** The function called when making a request to reset password */\n        this.handleSend = function (event) { return _this.send(event); };\n        /** The function called when submitting a new password */\n        this.handleSubmit = function (event) { return _this.submit(event); };\n        /** Auth state change handler for this component */\n        this.handleAuthStateChange = _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"d\"];\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        this.delivery = null;\n        this.loading = false;\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"h\"],\n            phoneNumberValue: null,\n        };\n        this.newFormFields = [];\n        this.forgotPasswordAttrs = {\n            userInput: '',\n            password: '',\n            code: '',\n        };\n    }\n    class_3.prototype.componentWillLoad = function () {\n        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"c\"])(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_3.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_3.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                _this.newFormFields.push(newField);\n            });\n        }\n    };\n    class_3.prototype.buildDefaultFormFields = function () {\n        switch (this.usernameAlias) {\n            case 'email':\n                this.newFormFields = [\n                    {\n                        type: 'email',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'forgot-password-email-input',\n                        },\n                    },\n                ];\n                break;\n            case 'phone_number':\n                this.newFormFields = [\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'forgot-password-phone-number-input',\n                        },\n                    },\n                ];\n                break;\n            case 'username':\n            default:\n                this.newFormFields = [\n                    {\n                        type: 'username',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('username'),\n                        inputProps: {\n                            'data-test': 'forgot-password-username-input',\n                        },\n                    },\n                ];\n                break;\n        }\n    };\n    class_3.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n            case 'email':\n                return function (event) { return (_this.forgotPasswordAttrs.userInput = event.target.value); };\n            case 'phone_number':\n                return function (event) { return Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"h\"])(event, _this.phoneNumber); };\n            case 'password':\n            case 'code':\n                return function (event) { return (_this.forgotPasswordAttrs[fieldType] = event.target.value); };\n            default:\n                return;\n        }\n    };\n    class_3.prototype.setFieldValue = function (field, formAttributes) {\n        switch (field.type) {\n            case 'username':\n            case 'email':\n                if (field.value === undefined) {\n                    formAttributes.userInput = '';\n                }\n                else {\n                    formAttributes.userInput = field.value;\n                }\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n            case 'password':\n            case 'code':\n                if (field.value === undefined) {\n                    formAttributes[field.type] = '';\n                }\n                else {\n                    formAttributes[field.type] = field.value;\n                }\n                break;\n        }\n    };\n    class_3.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    class_3.prototype.send = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, error_4;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].forgotPassword !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        this.loading = true;\n                        switch (this.usernameAlias) {\n                            case 'phone_number':\n                                try {\n                                    this.forgotPasswordAttrs.userInput = Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"b\"])(this.phoneNumber);\n                                }\n                                catch (error) {\n                                    Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error);\n                                }\n                                break;\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, 4, 5]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].forgotPassword(this.forgotPasswordAttrs.userInput)];\n                    case 2:\n                        data = _a.sent();\n                        logger.debug(data);\n                        this.newFormFields = [\n                            {\n                                type: 'code',\n                                required: true,\n                                handleInputChange: this.handleFormFieldInputChange('code'),\n                                inputProps: {\n                                    'data-test': 'forgot-password-code-input',\n                                },\n                            },\n                            {\n                                type: 'password',\n                                required: true,\n                                handleInputChange: this.handleFormFieldInputChange('password'),\n                                label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].NEW_PASSWORD_LABEL),\n                                placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].NEW_PASSWORD_PLACEHOLDER),\n                            },\n                        ];\n                        this.delivery = data.CodeDeliveryDetails;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_4 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_4);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_3.prototype.submit = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, userInput, code, password, data, error_5;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].forgotPasswordSubmit !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        this.loading = true;\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 3, 4, 5]);\n                        _a = this.forgotPasswordAttrs, userInput = _a.userInput, code = _a.code, password = _a.password;\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].forgotPasswordSubmit(userInput, code, password)];\n                    case 2:\n                        data = _b.sent();\n                        logger.debug(data);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignIn);\n                        this.delivery = null;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_5 = _b.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_5);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_3.prototype.render = function () {\n        var _this = this;\n        var submitFn = this.delivery ? function (event) { return _this.handleSubmit(event); } : function (event) { return _this.handleSend(event); };\n        var submitButtonText = this.delivery ? this.submitButtonText : this.sendButtonText;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"H\"], null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.headerText), handleSubmit: submitFn, loading: this.loading, secondaryFooterContent: Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignIn); }, \"data-test\": \"forgot-password-back-to-sign-in-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].BACK_TO_SIGN_IN)), testDataPrefix: 'forgot-password', submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(submitButtonText) }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-auth-fields\", { formFields: this.newFormFields }))));\n    };\n    Object.defineProperty(class_3, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_3;\n}());\nvar logger$1 = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"ConsoleLogger\"]('amplify-require-new-password');\nvar AmplifyRequireNewPassword = /** @class */ (function () {\n    function class_4(hostRef) {\n        var _this = this;\n        Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"r\"])(this, hostRef);\n        /** The header text of the forgot password section */\n        this.headerText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CHANGE_PASSWORD;\n        /** The text displayed inside of the submit button for the form */\n        this.submitButtonText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CHANGE_PASSWORD_ACTION;\n        /** The function called when submitting a new password */\n        this.handleSubmit = function (event) { return _this.completeNewPassword(event); };\n        /** Auth state change handler for this component */\n        this.handleAuthStateChange = _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"d\"];\n        /** The form fields displayed inside of the forgot password form */\n        this.formFields = [\n            {\n                type: _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"a\"].Password,\n                required: true,\n                handleInputChange: function (event) { return _this.handlePasswordChange(event); },\n                label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].NEW_PASSWORD_LABEL),\n                placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].NEW_PASSWORD_PLACEHOLDER),\n                inputProps: {\n                    'data-test': 'require-new-password-password-input',\n                },\n            },\n        ];\n        this.currentUser = this.user;\n        this.loading = false;\n        this.requiredAttributes = {};\n        this.newFormFields = this.formFields;\n    }\n    class_4.prototype.handleRequiredAttributeInputChange = function (attribute, event) {\n        this.requiredAttributes[attribute] = event.target.value;\n    };\n    class_4.prototype.componentWillLoad = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var user, error_6, userRequiredAttributes;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!!this.user) return [3 /*break*/, 4];\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].currentAuthenticatedUser()];\n                    case 2:\n                        user = _a.sent();\n                        if (user)\n                            this.currentUser = user;\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_6 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_6);\n                        return [3 /*break*/, 4];\n                    case 4:\n                        if (this.currentUser && this.currentUser.challengeParam.requiredAttributes) {\n                            userRequiredAttributes = this.currentUser.challengeParam.requiredAttributes;\n                            userRequiredAttributes.forEach(function (attribute) {\n                                var formField = {\n                                    type: attribute,\n                                    required: true,\n                                    label: _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"r\"][attribute].label,\n                                    placeholder: _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"r\"][attribute].placeholder,\n                                    handleInputChange: function (event) { return _this.handleRequiredAttributeInputChange(attribute, event); },\n                                    inputProps: {\n                                        'data-test': \"require-new-password-\" + attribute + \"-input\",\n                                    },\n                                };\n                                _this.newFormFields.push(formField);\n                            });\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_4.prototype.handlePasswordChange = function (event) {\n        this.password = event.target.value;\n    };\n    class_4.prototype.completeNewPassword = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var user, _a, error_7;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].completeNewPassword !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        this.loading = true;\n                        _b.label = 1;\n                    case 1:\n                        _b.trys.push([1, 8, 9, 10]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].completeNewPassword(this.currentUser, this.password, this.requiredAttributes)];\n                    case 2:\n                        user = _b.sent();\n                        logger$1.debug('complete new password', user);\n                        _a = user.challengeName;\n                        switch (_a) {\n                            case _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"C\"].SMSMFA: return [3 /*break*/, 3];\n                            case _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"C\"].MFASetup: return [3 /*break*/, 4];\n                        }\n                        return [3 /*break*/, 5];\n                    case 3:\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].ConfirmSignIn, user);\n                        return [3 /*break*/, 7];\n                    case 4:\n                        logger$1.debug('TOTP setup', user.challengeParam);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].TOTPSetup, user);\n                        return [3 /*break*/, 7];\n                    case 5: return [4 /*yield*/, Object(_auth_helpers_442d4bea_js__WEBPACK_IMPORTED_MODULE_7__[\"c\"])(user, this.handleAuthStateChange)];\n                    case 6:\n                        _b.sent();\n                        _b.label = 7;\n                    case 7: return [3 /*break*/, 10];\n                    case 8:\n                        error_7 = _b.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_7);\n                        return [3 /*break*/, 10];\n                    case 9:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 10: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_4.prototype.render = function () {\n        var _this = this;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"H\"], null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.headerText), handleSubmit: this.handleSubmit, loading: this.loading, secondaryFooterContent: Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignIn); } }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].BACK_TO_SIGN_IN)), submitButtonText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.submitButtonText) }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-auth-fields\", { formFields: this.newFormFields }))));\n    };\n    return class_4;\n}());\nvar amplifySignInCss = \":host{--footer-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--footer-font-family:var(--amplify-font-family);--font-weight:var(--amplify-font-weight)}.sign-in-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-in-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-in-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-in-form-footer amplify-button{margin-bottom:0}}.sign-in-form-footer *+*{margin-bottom:15px}\";\nvar AmplifySignIn = /** @class */ (function () {\n    function class_5(hostRef) {\n        var _this = this;\n        Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"r\"])(this, hostRef);\n        /** Fires when sign in form is submitted */\n        this.handleSubmit = function (event) { return _this.signIn(event); };\n        /** Used for header text in sign in component */\n        this.headerText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_IN_HEADER_TEXT;\n        /** Used for the submit button text in sign in component */\n        this.submitButtonText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_IN_ACTION;\n        /** Auth state change handler for this component */\n        this.handleAuthStateChange = _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"d\"];\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = [];\n        /** Hides the sign up link */\n        this.hideSignUp = false;\n        this.newFormFields = [];\n        /* Whether or not the sign-in component is loading */\n        this.loading = false;\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"h\"],\n            phoneNumberValue: null,\n        };\n        this.signInAttributes = {\n            userInput: '',\n            password: '',\n        };\n    }\n    class_5.prototype.componentWillLoad = function () {\n        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"c\"])(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_5.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_5.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n            case 'email':\n                return function (event) { return (_this.signInAttributes.userInput = event.target.value); };\n            case 'phone_number':\n                return function (event) { return Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"h\"])(event, _this.phoneNumber); };\n            case 'password':\n                return function (event) { return (_this.signInAttributes.password = event.target.value); };\n        }\n    };\n    class_5.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    class_5.prototype.signIn = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        // avoid submitting the form\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        this.loading = true;\n                        switch (this.usernameAlias) {\n                            case 'phone_number':\n                                try {\n                                    this.signInAttributes.userInput = Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"b\"])(this.phoneNumber);\n                                }\n                                catch (error) {\n                                    Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error);\n                                }\n                        }\n                        return [4 /*yield*/, Object(_auth_helpers_442d4bea_js__WEBPACK_IMPORTED_MODULE_7__[\"h\"])(this.signInAttributes.userInput, this.signInAttributes.password, this.handleAuthStateChange)];\n                    case 1:\n                        _a.sent();\n                        this.loading = false;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_5.prototype.buildDefaultFormFields = function () {\n        var _this = this;\n        var formFieldInputs = [];\n        switch (this.usernameAlias) {\n            case 'email':\n                formFieldInputs.push({\n                    type: 'email',\n                    required: true,\n                    handleInputChange: this.handleFormFieldInputChange('email'),\n                    inputProps: {\n                        'data-test': 'sign-in-email-input',\n                    },\n                });\n                break;\n            case 'phone_number':\n                formFieldInputs.push({\n                    type: 'phone_number',\n                    required: true,\n                    handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                    inputProps: {\n                        'data-test': 'sign-in-phone-number-input',\n                    },\n                });\n                break;\n            case 'username':\n            default:\n                formFieldInputs.push({\n                    type: 'username',\n                    required: true,\n                    handleInputChange: this.handleFormFieldInputChange('username'),\n                    inputProps: {\n                        'data-test': 'sign-in-username-input',\n                    },\n                });\n                break;\n        }\n        formFieldInputs.push({\n            type: 'password',\n            hint: (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].FORGOT_PASSWORD_TEXT), ' ', Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].ForgotPassword); }, \"data-test\": \"sign-in-forgot-password-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].RESET_PASSWORD_TEXT)))),\n            required: true,\n            handleInputChange: this.handleFormFieldInputChange('password'),\n            inputProps: {\n                'data-test': 'sign-in-password-input',\n            },\n        });\n        this.newFormFields = __spreadArrays(formFieldInputs);\n    };\n    class_5.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            var newFields_2 = [];\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                // TODO: handle hint better\n                if (newField.type === 'password') {\n                    newField['hint'] = Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"i\"])(newField) ? (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].FORGOT_PASSWORD_TEXT), ' ', Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].ForgotPassword); }, \"data-test\": \"sign-in-forgot-password-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].RESET_PASSWORD_TEXT)))) : (newField['hint']);\n                }\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                _this.setFieldValue(newField, _this.signInAttributes);\n                newFields_2.push(newField);\n            });\n            this.newFormFields = newFields_2;\n        }\n    };\n    class_5.prototype.setFieldValue = function (field, formAttributes) {\n        switch (field.type) {\n            case 'username':\n            case 'email':\n                if (field.value === undefined) {\n                    formAttributes.userInput = '';\n                }\n                else {\n                    formAttributes.userInput = field.value;\n                }\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n            case 'password':\n                if (field.value === undefined) {\n                    formAttributes.password = '';\n                }\n                else {\n                    formAttributes.password = field.value;\n                }\n                break;\n        }\n    };\n    class_5.prototype.render = function () {\n        var _this = this;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"H\"], null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.headerText), handleSubmit: this.handleSubmit, testDataPrefix: 'sign-in' }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", { slot: \"subtitle\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"header-subtitle\" })), Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"federated-buttons\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-federated-buttons\", { handleAuthStateChange: this.handleAuthStateChange, federated: this.federated })), !Object(_aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"isEmpty\"])(this.federated) && Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-strike\", null, \"or\"), Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-auth-fields\", { formFields: this.newFormFields }), Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", { slot: \"amplify-form-section-footer\", class: \"sign-in-form-footer\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"footer\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"secondary-footer-content\" }, !this.hideSignUp ? (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].NO_ACCOUNT_TEXT), ' ', Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignUp); }, \"data-test\": \"sign-in-create-account-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CREATE_ACCOUNT_TEXT)))) : (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null))), Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"primary-footer-content\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { type: \"submit\", disabled: this.loading, \"data-test\": \"sign-in-sign-in-button\" }, this.loading ? Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-loading-spinner\", null) : Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.submitButtonText)))))))));\n    };\n    Object.defineProperty(class_5, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_5;\n}());\nAmplifySignIn.style = amplifySignInCss;\nvar amplifySignUpCss = \":host{--footer-font-family:var(--amplify-font-family);--footer-font-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--font-weight:var(--amplify-font-weight)}.sign-up-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-font-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-up-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-up-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-up-form-footer amplify-button{margin-bottom:0}}.sign-up-form-footer *+*{margin-bottom:15px}\";\nvar AmplifySignUp = /** @class */ (function () {\n    function class_6(hostRef) {\n        var _this = this;\n        Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"r\"])(this, hostRef);\n        /** Fires when sign up form is submitted */\n        this.handleSubmit = function (event) { return _this.signUp(event); };\n        /** Used for header text in sign up component */\n        this.headerText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_HEADER_TEXT;\n        /** Used for the submit button text in sign up component */\n        this.submitButtonText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_SUBMIT_BUTTON_TEXT;\n        /** Used for the submit button text in sign up component */\n        this.haveAccountText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_HAVE_ACCOUNT_TEXT;\n        /** Text used for the sign in hyperlink */\n        this.signInText = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_IN_TEXT;\n        /**\n         * Form fields allows you to utilize our pre-built components such as username field, code field, password field, email field, etc.\n         * by passing an array of strings that you would like the order of the form to be in. If you need more customization, such as changing\n         * text for a label or adjust a placeholder, you can follow the structure below in order to do just that.\n         * ```\n         * [\n         *  {\n         *    type: string,\n         *    label: string,\n         *    placeholder: string,\n         *    hint: string | Functional Component | null,\n         *    required: boolean\n         *  }\n         * ]\n         * ```\n         */\n        this.formFields = [];\n        /** Auth state change handler for this component\n         * e.g. SignIn -> 'Create Account' link -> SignUp\n         */\n        this.handleAuthStateChange = _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"d\"];\n        /** Username Alias is used to setup authentication with `username`, `email` or `phone_number`  */\n        this.usernameAlias = 'username';\n        // private userInput: string | PhoneNumberInterface;\n        this.newFormFields = [];\n        this.phoneNumber = {\n            countryDialCodeValue: _constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"h\"],\n            phoneNumberValue: null,\n        };\n        this.loading = false;\n        this.signUpAttributes = {\n            username: '',\n            password: '',\n            attributes: {},\n        };\n    }\n    class_6.prototype.handleFormFieldInputChange = function (fieldType) {\n        var _this = this;\n        switch (fieldType) {\n            case 'username':\n                return function (event) { return (_this.signUpAttributes.username = event.target.value); };\n            case 'password':\n                return function (event) { return (_this.signUpAttributes.password = event.target.value); };\n            case 'email':\n                return function (event) { return (_this.signUpAttributes.attributes.email = event.target.value); };\n            case 'phone_number':\n                return function (event) { return Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"h\"])(event, _this.phoneNumber); };\n            default:\n                return function (event) { return (_this.signUpAttributes.attributes[fieldType] = event.target.value); };\n        }\n    };\n    class_6.prototype.handleFormFieldInputWithCallback = function (event, field) {\n        var fnToCall = field['handleInputChange']\n            ? field['handleInputChange']\n            : function (event, cb) {\n                cb(event);\n            };\n        var callback = this.handleFormFieldInputChange(field.type);\n        fnToCall(event, callback.bind(this));\n    };\n    // TODO: Add validation\n    // TODO: Prefix\n    class_6.prototype.signUp = function (event) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, signUpAttrs, error_8;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (event) {\n                            event.preventDefault();\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].signUp !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        if (this.phoneNumber.phoneNumberValue) {\n                            try {\n                                this.signUpAttributes.attributes.phone_number = Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"b\"])(this.phoneNumber);\n                            }\n                            catch (error) {\n                                Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error);\n                            }\n                        }\n                        switch (this.usernameAlias) {\n                            case 'email':\n                            case 'phone_number':\n                                this.signUpAttributes.username = this.signUpAttributes.attributes[this.usernameAlias];\n                                break;\n                        }\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 6, , 7]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].signUp(this.signUpAttributes)];\n                    case 2:\n                        data = _a.sent();\n                        if (!data) {\n                            throw new Error(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_FAILED);\n                        }\n                        if (!data.userConfirmed) return [3 /*break*/, 4];\n                        return [4 /*yield*/, Object(_auth_helpers_442d4bea_js__WEBPACK_IMPORTED_MODULE_7__[\"h\"])(this.signUpAttributes.username, this.signUpAttributes.password, this.handleAuthStateChange)];\n                    case 3:\n                        _a.sent();\n                        return [3 /*break*/, 5];\n                    case 4:\n                        signUpAttrs = Object.assign({}, this.signUpAttributes);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].ConfirmSignUp, Object.assign(Object.assign({}, data.user), { signUpAttrs: signUpAttrs }));\n                        _a.label = 5;\n                    case 5: return [3 /*break*/, 7];\n                    case 6:\n                        error_8 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_8);\n                        return [3 /*break*/, 7];\n                    case 7: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_6.prototype.buildDefaultFormFields = function () {\n        switch (this.usernameAlias) {\n            case 'email':\n                this.newFormFields = [\n                    {\n                        type: 'email',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_EMAIL_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'sign-up-email-input',\n                        },\n                    },\n                    {\n                        type: 'password',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_PASSWORD_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('password'),\n                        inputProps: {\n                            'data-test': 'sign-up-password-input',\n                        },\n                    },\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'sign-up-phone-number-input',\n                        },\n                    },\n                ];\n                break;\n            case 'phone_number':\n                this.newFormFields = [\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'sign-up-phone-number-input',\n                        },\n                    },\n                    {\n                        type: 'password',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_PASSWORD_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('password'),\n                        inputProps: {\n                            'data-test': 'sign-up-password-input',\n                        },\n                    },\n                    {\n                        type: 'email',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_EMAIL_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'sign-up-email-input',\n                        },\n                    },\n                ];\n                break;\n            case 'username':\n            default:\n                this.newFormFields = [\n                    {\n                        type: 'username',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_USERNAME_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('username'),\n                        inputProps: {\n                            'data-test': 'sign-up-username-input',\n                        },\n                    },\n                    {\n                        type: 'password',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_PASSWORD_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('password'),\n                        inputProps: {\n                            'data-test': 'sign-up-password-input',\n                        },\n                    },\n                    {\n                        type: 'email',\n                        placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].SIGN_UP_EMAIL_PLACEHOLDER),\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('email'),\n                        inputProps: {\n                            'data-test': 'sign-up-email-input',\n                        },\n                    },\n                    {\n                        type: 'phone_number',\n                        required: true,\n                        handleInputChange: this.handleFormFieldInputChange('phone_number'),\n                        inputProps: {\n                            'data-test': 'sign-up-phone-number-input',\n                        },\n                    },\n                ];\n                break;\n        }\n    };\n    class_6.prototype.buildFormFields = function () {\n        var _this = this;\n        if (this.formFields.length === 0) {\n            this.buildDefaultFormFields();\n        }\n        else {\n            var newFields_3 = [];\n            this.formFields.forEach(function (field) {\n                var newField = Object.assign({}, field);\n                newField['handleInputChange'] = function (event) { return _this.handleFormFieldInputWithCallback(event, field); };\n                _this.setFieldValue(field, _this.signUpAttributes);\n                newFields_3.push(newField);\n            });\n            this.newFormFields = newFields_3;\n        }\n    };\n    class_6.prototype.setFieldValue = function (field, formAttributes) {\n        switch (field.type) {\n            case 'username':\n                if (field.value === undefined) {\n                    formAttributes.username = '';\n                }\n                else {\n                    formAttributes.username = field.value;\n                }\n                break;\n            case 'password':\n                if (field.value === undefined) {\n                    formAttributes.password = '';\n                }\n                else {\n                    formAttributes.password = field.value;\n                }\n                break;\n            case 'email':\n                formAttributes.attributes.email = field.value;\n                break;\n            case 'phone_number':\n                if (field.dialCode) {\n                    this.phoneNumber.countryDialCodeValue = field.dialCode;\n                }\n                this.phoneNumber.phoneNumberValue = field.value;\n                break;\n            default:\n                formAttributes.attributes[field.type] = field.value;\n                break;\n        }\n    };\n    class_6.prototype.componentWillLoad = function () {\n        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"c\"])(this.usernameAlias);\n        this.buildFormFields();\n    };\n    class_6.prototype.formFieldsHandler = function () {\n        this.buildFormFields();\n    };\n    class_6.prototype.render = function () {\n        var _this = this;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"H\"], null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-form-section\", { headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.headerText), handleSubmit: this.handleSubmit, testDataPrefix: 'sign-up' }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", { slot: \"subtitle\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"header-subtitle\" })), Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-auth-fields\", { formFields: this.newFormFields }), Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", { class: \"sign-up-form-footer\", slot: \"amplify-form-section-footer\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"footer\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"secondary-footer-content\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.haveAccountText), ' ', Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignIn); }, \"data-test\": \"sign-up-sign-in-link\" }, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.signInText)))), Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"slot\", { name: \"primary-footer-content\" }, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { type: \"submit\", \"data-test\": \"sign-up-create-account-button\" }, this.loading ? Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-loading-spinner\", null) : Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null, _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(this.submitButtonText)))))))));\n    };\n    Object.defineProperty(class_6, \"watchers\", {\n        get: function () {\n            return {\n                \"formFields\": [\"formFieldsHandler\"]\n            };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return class_6;\n}());\nAmplifySignUp.style = amplifySignUpCss;\nvar logger$2 = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"Logger\"]('AmplifyVerifyContact');\nvar AmplifyVerifyContact = /** @class */ (function () {\n    function class_7(hostRef) {\n        Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"r\"])(this, hostRef);\n        /** Authentication state handler */\n        this.handleAuthStateChange = _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"d\"];\n        this.loading = false;\n    }\n    class_7.prototype.handleSubmit = function (event) {\n        event.preventDefault();\n        this.verifyAttr ? this.submit(this.code) : this.verify(this.contact);\n    };\n    class_7.prototype.submit = function (code) {\n        return __awaiter(this, void 0, void 0, function () {\n            var attr, data, error_9;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        attr = this.verifyAttr;\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].verifyCurrentUserAttributeSubmit !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        this.loading = true;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, 4, 5]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].verifyCurrentUserAttributeSubmit(attr, code)];\n                    case 2:\n                        data = _a.sent();\n                        logger$2.debug(data);\n                        this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignedIn, this.user);\n                        this.verifyAttr = null;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_9 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_9);\n                        logger$2.error(error_9);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_7.prototype.verify = function (contact) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, error_10;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!contact) {\n                            logger$2.error('Neither Email nor Phone Number selected');\n                            return [2 /*return*/];\n                        }\n                        if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].verifyCurrentUserAttribute !== 'function') {\n                            throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_5__[\"N\"]);\n                        }\n                        this.loading = true;\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, 4, 5]);\n                        return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_3__[\"Auth\"].verifyCurrentUserAttribute(contact)];\n                    case 2:\n                        data = _a.sent();\n                        logger$2.debug(data);\n                        this.verifyAttr = contact;\n                        return [3 /*break*/, 5];\n                    case 3:\n                        error_10 = _a.sent();\n                        Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_6__[\"a\"])(error_10);\n                        logger$2.error(error_10);\n                        return [3 /*break*/, 5];\n                    case 4:\n                        this.loading = false;\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    class_7.prototype.handleInputChange = function (event) {\n        var inputName = event.target.name;\n        if (inputName === 'code') {\n            this.code = event.target.value;\n        }\n        else if (inputName === 'contact') {\n            this.contact = event.target.value;\n        }\n    };\n    class_7.prototype.renderSubmit = function () {\n        var _this = this;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-input\", { inputProps: {\n                autocomplete: 'off',\n                'data-test': 'verify-contact-code-input',\n            }, name: \"code\", placeholder: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].CODE_PLACEHOLDER), handleInputChange: function (event) { return _this.handleInputChange(event); } })));\n    };\n    class_7.prototype.renderVerify = function () {\n        var _this = this;\n        var user = this.user;\n        if (!user) {\n            logger$2.debug('No user to verify');\n            return null;\n        }\n        var unverified = user.unverified;\n        if (!unverified) {\n            logger$2.debug('Unverified variable does not exist on user');\n            return null;\n        }\n        var email = unverified.email, phone_number = unverified.phone_number;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"div\", null, email && (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-radio-button\", { label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].VERIFY_CONTACT_EMAIL_LABEL), key: \"email\", name: \"contact\", value: \"email\", handleInputChange: function (event) { return _this.handleInputChange(event); }, inputProps: {\n                'data-test': 'verify-contact-email-radio',\n            } })), phone_number && (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-radio-button\", { label: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].VERIFY_CONTACT_PHONE_LABEL), key: \"phone_number\", name: \"contact\", value: \"phone_number\", handleInputChange: function (event) { return _this.handleInputChange(event); }, inputProps: {\n                'data-test': 'verify-contact-email-radio',\n            } }))));\n    };\n    class_7.prototype.render = function () {\n        var _this = this;\n        return (Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"H\"], null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-form-section\", { handleSubmit: function (event) { return _this.handleSubmit(event); }, headerText: _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].VERIFY_CONTACT_HEADER_TEXT), loading: this.loading, secondaryFooterContent: Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"span\", null, Object(_index_39969785_js__WEBPACK_IMPORTED_MODULE_0__[\"h\"])(\"amplify-button\", { variant: \"anchor\", onClick: function () { return _this.handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_2__[\"A\"].SignedIn, _this.user); } }, \"Skip\")), submitButtonText: this.verifyAttr\n                ? _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].VERIFY_CONTACT_SUBMIT_LABEL)\n                : _aws_amplify_core__WEBPACK_IMPORTED_MODULE_1__[\"I18n\"].get(_Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_4__[\"T\"].VERIFY_CONTACT_VERIFY_LABEL) }, this.verifyAttr ? this.renderSubmit() : this.renderVerify())));\n    };\n    return class_7;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L3VpLWNvbXBvbmVudHMvZGlzdC9lc20tZXM1L2FtcGxpZnktY29uZmlybS1zaWduLWluXzcuZW50cnkuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L3VpLWNvbXBvbmVudHMvZGlzdC9lc20tZXM1L2FtcGxpZnktY29uZmlybS1zaWduLWluXzcuZW50cnkuanM/ZTg2MiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xudmFyIF9fc3ByZWFkQXJyYXlzID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5cykgfHwgZnVuY3Rpb24gKCkge1xuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcbiAgICByZXR1cm4gcjtcbn07XG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGgsIEggYXMgSG9zdCB9IGZyb20gJy4vaW5kZXgtMzk5Njk3ODUuanMnO1xuaW1wb3J0IHsgSTE4biwgTG9nZ2VyLCBDb25zb2xlTG9nZ2VyLCBpc0VtcHR5IH0gZnJvbSAnQGF3cy1hbXBsaWZ5L2NvcmUnO1xuaW1wb3J0IHsgTSBhcyBNZmFPcHRpb24sIEMgYXMgQ2hhbGxlbmdlTmFtZSwgQSBhcyBBdXRoU3RhdGUsIGEgYXMgQXV0aEZvcm1GaWVsZCB9IGZyb20gJy4vYXV0aC10eXBlcy03OGRmMzA0ZS5qcyc7XG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnQGF3cy1hbXBsaWZ5L2F1dGgnO1xuaW1wb3J0IHsgVCBhcyBUcmFuc2xhdGlvbnMgfSBmcm9tICcuL1RyYW5zbGF0aW9ucy03MWFjYzY2MS5qcyc7XG5pbXBvcnQgeyBOIGFzIE5PX0FVVEhfTU9EVUxFX0ZPVU5ELCBoIGFzIENPVU5UUllfRElBTF9DT0RFX0RFRkFVTFQgfSBmcm9tICcuL2NvbnN0YW50cy1kMWFiZTdkZS5qcyc7XG5pbXBvcnQgeyBkIGFzIGRpc3BhdGNoQXV0aFN0YXRlQ2hhbmdlRXZlbnQsIGEgYXMgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50LCBjIGFzIGNoZWNrVXNlcm5hbWVBbGlhcywgaSBhcyBpc0hpbnRWYWxpZCwgaCBhcyBoYW5kbGVQaG9uZU51bWJlckNoYW5nZSwgYiBhcyBjb21wb3NlUGhvbmVOdW1iZXJJbnB1dCwgciBhcyByZXF1aXJlZEF0dHJpYnV0ZXNNYXAgfSBmcm9tICcuL2hlbHBlcnMtMDNiYjZhMzguanMnO1xuaW1wb3J0IHsgYyBhcyBjaGVja0NvbnRhY3QsIGggYXMgaGFuZGxlU2lnbkluIH0gZnJvbSAnLi9hdXRoLWhlbHBlcnMtNDQyZDRiZWEuanMnO1xudmFyIEFtcGxpZnlDb25maXJtU2lnbkluID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzEoaG9zdFJlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogRmlyZXMgd2hlbiBjb25maXJtIHNpZ24gaW4gZm9ybSBpcyBzdWJtaXR0ZWQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVTdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmNvbmZpcm0oZXZlbnQpOyB9O1xuICAgICAgICAvKiogVXNlZCBmb3IgaGVhZGVyIHRleHQgaW4gY29uZmlybSBzaWduIGluIGNvbXBvbmVudCAqL1xuICAgICAgICB0aGlzLmhlYWRlclRleHQgPSBUcmFuc2xhdGlvbnMuQ09ORklSTV9TTVNfQ09ERTtcbiAgICAgICAgLyoqIFVzZWQgZm9yIHRoZSBzdWJtaXQgYnV0dG9uIHRleHQgaW4gY29uZmlybSBzaWduIGluIGNvbXBvbmVudCAqL1xuICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvblRleHQgPSBUcmFuc2xhdGlvbnMuQ09ORklSTTtcbiAgICAgICAgLyoqIEF1dGggc3RhdGUgY2hhbmdlIGhhbmRsZXIgZm9yIHRoaXMgY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlID0gZGlzcGF0Y2hBdXRoU3RhdGVDaGFuZ2VFdmVudDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZvcm0gZmllbGRzIGFsbG93cyB5b3UgdG8gdXRpbGl6ZSBvdXIgcHJlLWJ1aWx0IGNvbXBvbmVudHMgc3VjaCBhcyB1c2VybmFtZSBmaWVsZCwgY29kZSBmaWVsZCwgcGFzc3dvcmQgZmllbGQsIGVtYWlsIGZpZWxkLCBldGMuXG4gICAgICAgICAqIGJ5IHBhc3NpbmcgYW4gYXJyYXkgb2Ygc3RyaW5ncyB0aGF0IHlvdSB3b3VsZCBsaWtlIHRoZSBvcmRlciBvZiB0aGUgZm9ybSB0byBiZSBpbi4gSWYgeW91IG5lZWQgbW9yZSBjdXN0b21pemF0aW9uLCBzdWNoIGFzIGNoYW5naW5nXG4gICAgICAgICAqIHRleHQgZm9yIGEgbGFiZWwgb3IgYWRqdXN0IGEgcGxhY2Vob2xkZXIsIHlvdSBjYW4gZm9sbG93IHRoZSBzdHJ1Y3R1cmUgYmVsb3cgaW4gb3JkZXIgdG8gZG8ganVzdCB0aGF0LlxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICogW1xuICAgICAgICAgKiAge1xuICAgICAgICAgKiAgICB0eXBlOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGxhYmVsOiBzdHJpbmcsXG4gICAgICAgICAqICAgIHBsYWNlaG9sZGVyOiBzdHJpbmcsXG4gICAgICAgICAqICAgIGhpbnQ6IHN0cmluZyB8IEZ1bmN0aW9uYWwgQ29tcG9uZW50IHwgbnVsbCxcbiAgICAgICAgICogICAgcmVxdWlyZWQ6IGJvb2xlYW5cbiAgICAgICAgICogIH1cbiAgICAgICAgICogXVxuICAgICAgICAgKiBgYGBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZm9ybUZpZWxkcyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnY29kZScsXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQ29kZUNoYW5nZShldmVudCk7IH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdO1xuICAgICAgICAvKiogVGhlIE1GQSBvcHRpb24gdG8gY29uZmlybSB3aXRoICovXG4gICAgICAgIHRoaXMubWZhT3B0aW9uID0gTWZhT3B0aW9uLlNNUztcbiAgICAgICAgLyogV2hldGhlciBvciBub3QgdGhlIGNvbmZpcm0tc2lnbi1pbiBjb21wb25lbnQgaXMgbG9hZGluZyAqL1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgY2xhc3NfMS5wcm90b3R5cGUuY29tcG9uZW50V2lsbExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnVzZXIgJiYgdGhpcy51c2VyWydjaGFsbGVuZ2VOYW1lJ10gPT09IENoYWxsZW5nZU5hbWUuU29mdHdhcmVUb2tlbk1GQSkge1xuICAgICAgICAgICAgdGhpcy5tZmFPcHRpb24gPSBNZmFPcHRpb24uVE9UUDtcbiAgICAgICAgICAgIC8vIElmIGhlYWRlciB0ZXh0IGlzIHVzaW5nIGRlZmF1bHQgdXNlIFRPVFAgc3RyaW5nXG4gICAgICAgICAgICBpZiAodGhpcy5oZWFkZXJUZXh0ID09PSBUcmFuc2xhdGlvbnMuQ09ORklSTV9TTVNfQ09ERSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyVGV4dCA9IFRyYW5zbGF0aW9ucy5DT05GSVJNX1RPVFBfQ09ERTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfMS5wcm90b3R5cGUuaGFuZGxlQ29kZUNoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLmNvZGUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgfTtcbiAgICBjbGFzc18xLnByb3RvdHlwZS5jb25maXJtID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtZmFUeXBlLCBlcnJvcl8xO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1mYVR5cGUgPSB0aGlzLnVzZXJbJ2NoYWxsZW5nZU5hbWUnXSA9PT0gQ2hhbGxlbmdlTmFtZS5Tb2Z0d2FyZVRva2VuTUZBID8gQ2hhbGxlbmdlTmFtZS5Tb2Z0d2FyZVRva2VuTUZBIDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5jb25maXJtU2lnbkluICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgNCwgNSwgNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgQXV0aC5jb25maXJtU2lnbkluKHRoaXMudXNlciwgdGhpcy5jb2RlLCBtZmFUeXBlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNoZWNrQ29udGFjdCh0aGlzLnVzZXIsIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfMS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImFtcGxpZnktZm9ybS1zZWN0aW9uXCIsIHsgaGVhZGVyVGV4dDogSTE4bi5nZXQodGhpcy5oZWFkZXJUZXh0KSwgaGFuZGxlU3VibWl0OiB0aGlzLmhhbmRsZVN1Ym1pdCwgc3VibWl0QnV0dG9uVGV4dDogSTE4bi5nZXQodGhpcy5zdWJtaXRCdXR0b25UZXh0KSwgbG9hZGluZzogdGhpcy5sb2FkaW5nLCBzZWNvbmRhcnlGb290ZXJDb250ZW50OiBoKFwic3BhblwiLCBudWxsLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25Jbik7IH0gfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkJBQ0tfVE9fU0lHTl9JTikpKSB9LCBoKFwiYW1wbGlmeS1hdXRoLWZpZWxkc1wiLCB7IGZvcm1GaWVsZHM6IHRoaXMuZm9ybUZpZWxkcyB9KSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBjbGFzc18xO1xufSgpKTtcbnZhciBBbXBsaWZ5Q29uZmlybVNpZ25VcCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBjbGFzc18yKGhvc3RSZWYpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgLyoqIEZpcmVzIHdoZW4gc2lnbiB1cCBmb3JtIGlzIHN1Ym1pdHRlZCAqL1xuICAgICAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuY29uZmlybVNpZ25VcChldmVudCk7IH07XG4gICAgICAgIC8qKiBVc2VkIGZvciBoZWFkZXIgdGV4dCBpbiBjb25maXJtIHNpZ24gdXAgY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuaGVhZGVyVGV4dCA9IFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfSEVBREVSX1RFWFQ7XG4gICAgICAgIC8qKiBVc2VkIGZvciB0aGUgc3VibWl0IGJ1dHRvbiB0ZXh0IGluIGNvbmZpcm0gc2lnbiB1cCBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5zdWJtaXRCdXR0b25UZXh0ID0gVHJhbnNsYXRpb25zLkNPTkZJUk1fU0lHTl9VUF9TVUJNSVRfQlVUVE9OX1RFWFQ7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGb3JtIGZpZWxkcyBhbGxvd3MgeW91IHRvIHV0aWxpemUgb3VyIHByZS1idWlsdCBjb21wb25lbnRzIHN1Y2ggYXMgdXNlcm5hbWUgZmllbGQsIGNvZGUgZmllbGQsIHBhc3N3b3JkIGZpZWxkLCBlbWFpbCBmaWVsZCwgZXRjLlxuICAgICAgICAgKiBieSBwYXNzaW5nIGFuIGFycmF5IG9mIHN0cmluZ3MgdGhhdCB5b3Ugd291bGQgbGlrZSB0aGUgb3JkZXIgb2YgdGhlIGZvcm0gdG8gYmUgaW4uIElmIHlvdSBuZWVkIG1vcmUgY3VzdG9taXphdGlvbiwgc3VjaCBhcyBjaGFuZ2luZ1xuICAgICAgICAgKiB0ZXh0IGZvciBhIGxhYmVsIG9yIGFkanVzdCBhIHBsYWNlaG9sZGVyLCB5b3UgY2FuIGZvbGxvdyB0aGUgc3RydWN0dXJlIGJlbG93IGluIG9yZGVyIHRvIGRvIGp1c3QgdGhhdC5cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqIFtcbiAgICAgICAgICogIHtcbiAgICAgICAgICogICAgdHlwZTogc3RyaW5nLFxuICAgICAgICAgKiAgICBsYWJlbDogc3RyaW5nLFxuICAgICAgICAgKiAgICBwbGFjZWhvbGRlcjogc3RyaW5nLFxuICAgICAgICAgKiAgICBoaW50OiBzdHJpbmcgfCBGdW5jdGlvbmFsIENvbXBvbmVudCB8IG51bGwsXG4gICAgICAgICAqICAgIHJlcXVpcmVkOiBib29sZWFuXG4gICAgICAgICAqICB9XG4gICAgICAgICAqIF1cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZvcm1GaWVsZHMgPSBbXTtcbiAgICAgICAgLyoqIEF1dGggc3RhdGUgY2hhbmdlIGhhbmRsZXIgZm9yIHRoaXMgY29tcG9uZW50c1xuICAgICAgICAgKiBlLmcuIFNpZ25JbiAtPiAnQ3JlYXRlIEFjY291bnQnIGxpbmsgLT4gU2lnblVwXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZSA9IGRpc3BhdGNoQXV0aFN0YXRlQ2hhbmdlRXZlbnQ7XG4gICAgICAgIC8qKiBVc2VybmFtZSBBbGlhcyBpcyB1c2VkIHRvIHNldHVwIGF1dGhlbnRpY2F0aW9uIHdpdGggYHVzZXJuYW1lYCwgYGVtYWlsYCBvciBgcGhvbmVfbnVtYmVyYCAgKi9cbiAgICAgICAgdGhpcy51c2VybmFtZUFsaWFzID0gJ3VzZXJuYW1lJztcbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXNlcklucHV0ID0gdGhpcy51c2VyID8gdGhpcy51c2VyLnVzZXJuYW1lIDogbnVsbDtcbiAgICAgICAgdGhpcy5fc2lnblVwQXR0cnMgPSB0aGlzLnVzZXIgJiYgdGhpcy51c2VyLnNpZ25VcEF0dHJzID8gdGhpcy51c2VyLnNpZ25VcEF0dHJzIDogbnVsbDtcbiAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW107XG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSB7XG4gICAgICAgICAgICBjb3VudHJ5RGlhbENvZGVWYWx1ZTogQ09VTlRSWV9ESUFMX0NPREVfREVGQVVMVCxcbiAgICAgICAgICAgIHBob25lTnVtYmVyVmFsdWU6IG51bGwsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNsYXNzXzIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxMb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja1VzZXJuYW1lQWxpYXModGhpcy51c2VybmFtZUFsaWFzKTtcbiAgICAgICAgdGhpcy5idWlsZEZvcm1GaWVsZHMoKTtcbiAgICB9O1xuICAgIGNsYXNzXzIucHJvdG90eXBlLmZvcm1GaWVsZHNIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmJ1aWxkRm9ybUZpZWxkcygpO1xuICAgIH07XG4gICAgY2xhc3NfMi5wcm90b3R5cGUuYnVpbGREZWZhdWx0Rm9ybUZpZWxkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiXCIgKyB0aGlzLnVzZXJuYW1lQWxpYXMsXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoXCJcIiArIHRoaXMudXNlcm5hbWVBbGlhcyksXG4gICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMudXNlcklucHV0LFxuICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLnVzZXJJbnB1dCA/IHRydWUgOiBmYWxzZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2NvZGUnLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBJMThuLmdldChUcmFuc2xhdGlvbnMuQ09ORklSTV9TSUdOX1VQX0NPREVfTEFCRUwpLFxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBJMThuLmdldChUcmFuc2xhdGlvbnMuQ09ORklSTV9TSUdOX1VQX0NPREVfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGhpbnQ6IChoKFwiZGl2XCIsIG51bGwsIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfTE9TVF9DT0RFKSwgJyAnLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5yZXNlbmRDb25maXJtQ29kZSgpOyB9IH0sIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfUkVTRU5EX0NPREUpKSkpLFxuICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdjb2RlJyksXG4gICAgICAgICAgICB9LFxuICAgICAgICBdO1xuICAgIH07XG4gICAgY2xhc3NfMi5wcm90b3R5cGUuYnVpbGRGb3JtRmllbGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5mb3JtRmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5idWlsZERlZmF1bHRGb3JtRmllbGRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmV3RmllbGRzXzEgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuZm9ybUZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdGaWVsZCA9IE9iamVjdC5hc3NpZ24oe30sIGZpZWxkKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3RmllbGQudHlwZSA9PT0gJ2NvZGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkWydoaW50J10gPSBpc0hpbnRWYWxpZChuZXdGaWVsZCkgPyAoaChcImRpdlwiLCBudWxsLCBJMThuLmdldChUcmFuc2xhdGlvbnMuQ09ORklSTV9TSUdOX1VQX0xPU1RfQ09ERSksICcgJywgaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucmVzZW5kQ29uZmlybUNvZGUoKTsgfSB9LCBJMThuLmdldChUcmFuc2xhdGlvbnMuQ09ORklSTV9TSUdOX1VQX1JFU0VORF9DT0RFKSkpKSA6IChuZXdGaWVsZFsnaGludCddKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV3RmllbGRbJ2hhbmRsZUlucHV0Q2hhbmdlJ10gPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0V2l0aENhbGxiYWNrKGV2ZW50LCBmaWVsZCk7IH07XG4gICAgICAgICAgICAgICAgbmV3RmllbGRzXzEucHVzaChuZXdGaWVsZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IG5ld0ZpZWxkc18xO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc18yLnByb3RvdHlwZS5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSA9IGZ1bmN0aW9uIChmaWVsZFR5cGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgc3dpdGNoIChmaWVsZFR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3VzZXJuYW1lJzpcbiAgICAgICAgICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiAoX3RoaXMudXNlcklucHV0ID0gZXZlbnQudGFyZ2V0LnZhbHVlKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bob25lX251bWJlcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gaGFuZGxlUGhvbmVOdW1iZXJDaGFuZ2UoZXZlbnQsIF90aGlzLnBob25lTnVtYmVyKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ2NvZGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5jb2RlID0gZXZlbnQudGFyZ2V0LnZhbHVlKTsgfTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc18yLnByb3RvdHlwZS5zZXRGaWVsZFZhbHVlID0gZnVuY3Rpb24gKGZpZWxkKSB7XG4gICAgICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXNlcklucHV0ID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVzZXJJbnB1dCA9IGZpZWxkLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Bob25lX251bWJlcic6XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLmRpYWxDb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGhvbmVOdW1iZXIuY291bnRyeURpYWxDb2RlVmFsdWUgPSBmaWVsZC5kaWFsQ29kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5waG9uZU51bWJlci5waG9uZU51bWJlclZhbHVlID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzIucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0V2l0aENhbGxiYWNrID0gZnVuY3Rpb24gKGV2ZW50LCBmaWVsZCkge1xuICAgICAgICB2YXIgZm5Ub0NhbGwgPSBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgPyBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgOiBmdW5jdGlvbiAoZXZlbnQsIGNiKSB7XG4gICAgICAgICAgICAgICAgY2IoZXZlbnQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZShmaWVsZC50eXBlKTtcbiAgICAgICAgZm5Ub0NhbGwoZXZlbnQsIGNhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgIH07XG4gICAgY2xhc3NfMi5wcm90b3R5cGUucmVzZW5kQ29uZmlybUNvZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlcnJvcl8yO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5yZXNlbmRTaWduVXAgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9fQVVUSF9NT0RVTEVfRk9VTkQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDMsICwgNF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVzZXJJbnB1dClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXJuYW1lIGNhbiBub3QgYmUgZW1wdHknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGgucmVzZW5kU2lnblVwKHRoaXMudXNlcklucHV0KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5Db25maXJtU2lnblVwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8yID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8vIFRPRE86IEFkZCB2YWxpZGF0aW9uXG4gICAgLy8gVE9ETzogUHJlZml4XG4gICAgY2xhc3NfMi5wcm90b3R5cGUuY29uZmlybVNpZ25VcCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY29uZmlybVNpZ25VcFJlc3VsdCwgZXJyb3JfMztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUF1dGggfHwgdHlwZW9mIEF1dGguY29uZmlybVNpZ25VcCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihOT19BVVRIX01PRFVMRV9GT1VORCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJuYW1lQWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VySW5wdXQgPSBjb21wb3NlUGhvbmVOdW1iZXJJbnB1dCh0aGlzLnBob25lTnVtYmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCA2LCA3LCA4XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmNvbmZpcm1TaWduVXAodGhpcy51c2VySW5wdXQsIHRoaXMuY29kZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25maXJtU2lnblVwUmVzdWx0ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb25maXJtU2lnblVwUmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT05GSVJNX1NJR05fVVBfRkFJTEVEKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLl9zaWduVXBBdHRycyAmJiB0aGlzLl9zaWduVXBBdHRycy5wYXNzd29yZCAmJiB0aGlzLl9zaWduVXBBdHRycy5wYXNzd29yZCAhPT0gJycpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEF1dG8gc2lnbiBpbiB1c2VyIGlmIHBhc3N3b3JkIGlzIGF2YWlsYWJsZSBmcm9tIHByZXZpb3VzIHdvcmtmbG93XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBoYW5kbGVTaWduSW4odGhpcy51c2VySW5wdXQsIHRoaXMuX3NpZ25VcEF0dHJzLnBhc3N3b3JkLCB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBdXRvIHNpZ24gaW4gdXNlciBpZiBwYXNzd29yZCBpcyBhdmFpbGFibGUgZnJvbSBwcmV2aW91cyB3b3JrZmxvd1xuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduSW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA1O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8zID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfMi5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImFtcGxpZnktZm9ybS1zZWN0aW9uXCIsIHsgaGVhZGVyVGV4dDogSTE4bi5nZXQodGhpcy5oZWFkZXJUZXh0KSwgc3VibWl0QnV0dG9uVGV4dDogSTE4bi5nZXQodGhpcy5zdWJtaXRCdXR0b25UZXh0KSwgaGFuZGxlU3VibWl0OiB0aGlzLmhhbmRsZVN1Ym1pdCwgc2Vjb25kYXJ5Rm9vdGVyQ29udGVudDogaChcImRpdlwiLCBudWxsLCBoKFwic3BhblwiLCBudWxsLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25Jbik7IH0gfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkJBQ0tfVE9fU0lHTl9JTikpKSkgfSwgaChcImFtcGxpZnktYXV0aC1maWVsZHNcIiwgeyBmb3JtRmllbGRzOiB0aGlzLm5ld0Zvcm1GaWVsZHMgfSkpKSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xhc3NfMiwgXCJ3YXRjaGVyc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBcImZvcm1GaWVsZHNcIjogW1wiZm9ybUZpZWxkc0hhbmRsZXJcIl1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gY2xhc3NfMjtcbn0oKSk7XG52YXIgbG9nZ2VyID0gbmV3IExvZ2dlcignRm9yZ290UGFzc3dvcmQnKTtcbnZhciBBbXBsaWZ5Rm9yZ290UGFzc3dvcmQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gY2xhc3NfMyhob3N0UmVmKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XG4gICAgICAgIC8qKiBUaGUgaGVhZGVyIHRleHQgb2YgdGhlIGZvcmdvdCBwYXNzd29yZCBzZWN0aW9uICovXG4gICAgICAgIHRoaXMuaGVhZGVyVGV4dCA9IFRyYW5zbGF0aW9ucy5SRVNFVF9ZT1VSX1BBU1NXT1JEO1xuICAgICAgICAvKiogVGhlIHRleHQgZGlzcGxheWVkIGluc2lkZSBvZiB0aGUgc2VuZCBjb2RlIGJ1dHRvbiBmb3IgdGhlIGZvcm0gKi9cbiAgICAgICAgdGhpcy5zZW5kQnV0dG9uVGV4dCA9IFRyYW5zbGF0aW9ucy5TRU5EX0NPREU7XG4gICAgICAgIC8qKiBUaGUgdGV4dCBkaXNwbGF5ZWQgaW5zaWRlIG9mIHRoZSBzdWJtaXQgYnV0dG9uIGZvciB0aGUgZm9ybSAqL1xuICAgICAgICB0aGlzLnN1Ym1pdEJ1dHRvblRleHQgPSBUcmFuc2xhdGlvbnMuU1VCTUlUO1xuICAgICAgICAvKiogVGhlIGZvcm0gZmllbGRzIGRpc3BsYXllZCBpbnNpZGUgb2YgdGhlIGZvcmdvdCBwYXNzd29yZCBmb3JtICovXG4gICAgICAgIHRoaXMuZm9ybUZpZWxkcyA9IFtdO1xuICAgICAgICAvKiogVGhlIGZ1bmN0aW9uIGNhbGxlZCB3aGVuIG1ha2luZyBhIHJlcXVlc3QgdG8gcmVzZXQgcGFzc3dvcmQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVTZW5kID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5zZW5kKGV2ZW50KTsgfTtcbiAgICAgICAgLyoqIFRoZSBmdW5jdGlvbiBjYWxsZWQgd2hlbiBzdWJtaXR0aW5nIGEgbmV3IHBhc3N3b3JkICovXG4gICAgICAgIHRoaXMuaGFuZGxlU3VibWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5zdWJtaXQoZXZlbnQpOyB9O1xuICAgICAgICAvKiogQXV0aCBzdGF0ZSBjaGFuZ2UgaGFuZGxlciBmb3IgdGhpcyBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UgPSBkaXNwYXRjaEF1dGhTdGF0ZUNoYW5nZUV2ZW50O1xuICAgICAgICAvKiogVXNlcm5hbWUgQWxpYXMgaXMgdXNlZCB0byBzZXR1cCBhdXRoZW50aWNhdGlvbiB3aXRoIGB1c2VybmFtZWAsIGBlbWFpbGAgb3IgYHBob25lX251bWJlcmAgICovXG4gICAgICAgIHRoaXMudXNlcm5hbWVBbGlhcyA9ICd1c2VybmFtZSc7XG4gICAgICAgIHRoaXMuZGVsaXZlcnkgPSBudWxsO1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5waG9uZU51bWJlciA9IHtcbiAgICAgICAgICAgIGNvdW50cnlEaWFsQ29kZVZhbHVlOiBDT1VOVFJZX0RJQUxfQ09ERV9ERUZBVUxULFxuICAgICAgICAgICAgcGhvbmVOdW1iZXJWYWx1ZTogbnVsbCxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW107XG4gICAgICAgIHRoaXMuZm9yZ290UGFzc3dvcmRBdHRycyA9IHtcbiAgICAgICAgICAgIHVzZXJJbnB1dDogJycsXG4gICAgICAgICAgICBwYXNzd29yZDogJycsXG4gICAgICAgICAgICBjb2RlOiAnJyxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuY29tcG9uZW50V2lsbExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrVXNlcm5hbWVBbGlhcyh0aGlzLnVzZXJuYW1lQWxpYXMpO1xuICAgICAgICB0aGlzLmJ1aWxkRm9ybUZpZWxkcygpO1xuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuZm9ybUZpZWxkc0hhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYnVpbGRGb3JtRmllbGRzKCk7XG4gICAgfTtcbiAgICBjbGFzc18zLnByb3RvdHlwZS5idWlsZEZvcm1GaWVsZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmZvcm1GaWVsZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkRGVmYXVsdEZvcm1GaWVsZHMoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZm9ybUZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdGaWVsZCA9IE9iamVjdC5hc3NpZ24oe30sIGZpZWxkKTtcbiAgICAgICAgICAgICAgICBuZXdGaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXSA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRXaXRoQ2FsbGJhY2soZXZlbnQsIGZpZWxkKTsgfTtcbiAgICAgICAgICAgICAgICBfdGhpcy5uZXdGb3JtRmllbGRzLnB1c2gobmV3RmllbGQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzMucHJvdG90eXBlLmJ1aWxkRGVmYXVsdEZvcm1GaWVsZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy51c2VybmFtZUFsaWFzKSB7XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1haWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgnZW1haWwnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ2ZvcmdvdC1wYXNzd29yZC1lbWFpbC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bob25lX251bWJlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdwaG9uZV9udW1iZXInKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ2ZvcmdvdC1wYXNzd29yZC1waG9uZS1udW1iZXItaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd1c2VybmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCd1c2VybmFtZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnZm9yZ290LXBhc3N3b3JkLXVzZXJuYW1lLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoZmllbGRUeXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHN3aXRjaCAoZmllbGRUeXBlKSB7XG4gICAgICAgICAgICBjYXNlICd1c2VybmFtZSc6XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gKF90aGlzLmZvcmdvdFBhc3N3b3JkQXR0cnMudXNlcklucHV0ID0gZXZlbnQudGFyZ2V0LnZhbHVlKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bob25lX251bWJlcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gaGFuZGxlUGhvbmVOdW1iZXJDaGFuZ2UoZXZlbnQsIF90aGlzLnBob25lTnVtYmVyKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgIGNhc2UgJ2NvZGUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5mb3Jnb3RQYXNzd29yZEF0dHJzW2ZpZWxkVHlwZV0gPSBldmVudC50YXJnZXQudmFsdWUpOyB9O1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzMucHJvdG90eXBlLnNldEZpZWxkVmFsdWUgPSBmdW5jdGlvbiAoZmllbGQsIGZvcm1BdHRyaWJ1dGVzKSB7XG4gICAgICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLnVzZXJJbnB1dCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMudXNlcklucHV0ID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQuZGlhbENvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5waG9uZU51bWJlci5jb3VudHJ5RGlhbENvZGVWYWx1ZSA9IGZpZWxkLmRpYWxDb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBob25lTnVtYmVyLnBob25lTnVtYmVyVmFsdWUgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgIGNhc2UgJ2NvZGUnOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzW2ZpZWxkLnR5cGVdID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3JtQXR0cmlidXRlc1tmaWVsZC50eXBlXSA9IGZpZWxkLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuaGFuZGxlRm9ybUZpZWxkSW5wdXRXaXRoQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZXZlbnQsIGZpZWxkKSB7XG4gICAgICAgIHZhciBmblRvQ2FsbCA9IGZpZWxkWydoYW5kbGVJbnB1dENoYW5nZSddXG4gICAgICAgICAgICA/IGZpZWxkWydoYW5kbGVJbnB1dENoYW5nZSddXG4gICAgICAgICAgICA6IGZ1bmN0aW9uIChldmVudCwgY2IpIHtcbiAgICAgICAgICAgICAgICBjYihldmVudCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKGZpZWxkLnR5cGUpO1xuICAgICAgICBmblRvQ2FsbChldmVudCwgY2FsbGJhY2suYmluZCh0aGlzKSk7XG4gICAgfTtcbiAgICBjbGFzc18zLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkYXRhLCBlcnJvcl80O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5mb3Jnb3RQYXNzd29yZCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihOT19BVVRIX01PRFVMRV9GT1VORCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJuYW1lQWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3Jnb3RQYXNzd29yZEF0dHJzLnVzZXJJbnB1dCA9IGNvbXBvc2VQaG9uZU51bWJlcklucHV0KHRoaXMucGhvbmVOdW1iZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCA0LCA1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmZvcmdvdFBhc3N3b3JkKHRoaXMuZm9yZ290UGFzc3dvcmRBdHRycy51c2VySW5wdXQpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjb2RlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdjb2RlJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnZm9yZ290LXBhc3N3b3JkLWNvZGUtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3Bhc3N3b3JkJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBJMThuLmdldChUcmFuc2xhdGlvbnMuTkVXX1BBU1NXT1JEX0xBQkVMKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5ORVdfUEFTU1dPUkRfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxpdmVyeSA9IGRhdGEuQ29kZURlbGl2ZXJ5RGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl80ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUuc3VibWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfYSwgdXNlcklucHV0LCBjb2RlLCBwYXNzd29yZCwgZGF0YSwgZXJyb3JfNTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUF1dGggfHwgdHlwZW9mIEF1dGguZm9yZ290UGFzc3dvcmRTdWJtaXQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9fQVVUSF9NT0RVTEVfRk9VTkQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsxLCAzLCA0LCA1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMuZm9yZ290UGFzc3dvcmRBdHRycywgdXNlcklucHV0ID0gX2EudXNlcklucHV0LCBjb2RlID0gX2EuY29kZSwgcGFzc3dvcmQgPSBfYS5wYXNzd29yZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGguZm9yZ290UGFzc3dvcmRTdWJtaXQodXNlcklucHV0LCBjb2RlLCBwYXNzd29yZCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25Jbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGl2ZXJ5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl81ID0gX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfMy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgc3VibWl0Rm4gPSB0aGlzLmRlbGl2ZXJ5ID8gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVTdWJtaXQoZXZlbnQpOyB9IDogZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVTZW5kKGV2ZW50KTsgfTtcbiAgICAgICAgdmFyIHN1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLmRlbGl2ZXJ5ID8gdGhpcy5zdWJtaXRCdXR0b25UZXh0IDogdGhpcy5zZW5kQnV0dG9uVGV4dDtcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhbXBsaWZ5LWZvcm0tc2VjdGlvblwiLCB7IGhlYWRlclRleHQ6IEkxOG4uZ2V0KHRoaXMuaGVhZGVyVGV4dCksIGhhbmRsZVN1Ym1pdDogc3VibWl0Rm4sIGxvYWRpbmc6IHRoaXMubG9hZGluZywgc2Vjb25kYXJ5Rm9vdGVyQ29udGVudDogaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduSW4pOyB9LCBcImRhdGEtdGVzdFwiOiBcImZvcmdvdC1wYXNzd29yZC1iYWNrLXRvLXNpZ24taW4tbGlua1wiIH0sIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5CQUNLX1RPX1NJR05fSU4pKSwgdGVzdERhdGFQcmVmaXg6ICdmb3Jnb3QtcGFzc3dvcmQnLCBzdWJtaXRCdXR0b25UZXh0OiBJMThuLmdldChzdWJtaXRCdXR0b25UZXh0KSB9LCBoKFwiYW1wbGlmeS1hdXRoLWZpZWxkc1wiLCB7IGZvcm1GaWVsZHM6IHRoaXMubmV3Rm9ybUZpZWxkcyB9KSkpKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbGFzc18zLCBcIndhdGNoZXJzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIFwiZm9ybUZpZWxkc1wiOiBbXCJmb3JtRmllbGRzSGFuZGxlclwiXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBjbGFzc18zO1xufSgpKTtcbnZhciBsb2dnZXIkMSA9IG5ldyBDb25zb2xlTG9nZ2VyKCdhbXBsaWZ5LXJlcXVpcmUtbmV3LXBhc3N3b3JkJyk7XG52YXIgQW1wbGlmeVJlcXVpcmVOZXdQYXNzd29yZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBjbGFzc180KGhvc3RSZWYpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICAgICAgLyoqIFRoZSBoZWFkZXIgdGV4dCBvZiB0aGUgZm9yZ290IHBhc3N3b3JkIHNlY3Rpb24gKi9cbiAgICAgICAgdGhpcy5oZWFkZXJUZXh0ID0gVHJhbnNsYXRpb25zLkNIQU5HRV9QQVNTV09SRDtcbiAgICAgICAgLyoqIFRoZSB0ZXh0IGRpc3BsYXllZCBpbnNpZGUgb2YgdGhlIHN1Ym1pdCBidXR0b24gZm9yIHRoZSBmb3JtICovXG4gICAgICAgIHRoaXMuc3VibWl0QnV0dG9uVGV4dCA9IFRyYW5zbGF0aW9ucy5DSEFOR0VfUEFTU1dPUkRfQUNUSU9OO1xuICAgICAgICAvKiogVGhlIGZ1bmN0aW9uIGNhbGxlZCB3aGVuIHN1Ym1pdHRpbmcgYSBuZXcgcGFzc3dvcmQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVTdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmNvbXBsZXRlTmV3UGFzc3dvcmQoZXZlbnQpOyB9O1xuICAgICAgICAvKiogQXV0aCBzdGF0ZSBjaGFuZ2UgaGFuZGxlciBmb3IgdGhpcyBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UgPSBkaXNwYXRjaEF1dGhTdGF0ZUNoYW5nZUV2ZW50O1xuICAgICAgICAvKiogVGhlIGZvcm0gZmllbGRzIGRpc3BsYXllZCBpbnNpZGUgb2YgdGhlIGZvcmdvdCBwYXNzd29yZCBmb3JtICovXG4gICAgICAgIHRoaXMuZm9ybUZpZWxkcyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBBdXRoRm9ybUZpZWxkLlBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZVBhc3N3b3JkQ2hhbmdlKGV2ZW50KTsgfSxcbiAgICAgICAgICAgICAgICBsYWJlbDogSTE4bi5nZXQoVHJhbnNsYXRpb25zLk5FV19QQVNTV09SRF9MQUJFTCksXG4gICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5ORVdfUEFTU1dPUkRfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdyZXF1aXJlLW5ldy1wYXNzd29yZC1wYXNzd29yZC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF07XG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB0aGlzLnVzZXI7XG4gICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlcXVpcmVkQXR0cmlidXRlcyA9IHt9O1xuICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSB0aGlzLmZvcm1GaWVsZHM7XG4gICAgfVxuICAgIGNsYXNzXzQucHJvdG90eXBlLmhhbmRsZVJlcXVpcmVkQXR0cmlidXRlSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoYXR0cmlidXRlLCBldmVudCkge1xuICAgICAgICB0aGlzLnJlcXVpcmVkQXR0cmlidXRlc1thdHRyaWJ1dGVdID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIH07XG4gICAgY2xhc3NfNC5wcm90b3R5cGUuY29tcG9uZW50V2lsbExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB1c2VyLCBlcnJvcl82LCB1c2VyUmVxdWlyZWRBdHRyaWJ1dGVzO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMudXNlcikgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLmN1cnJlbnRBdXRoZW50aWNhdGVkVXNlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1c2VyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzYgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfNik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci5jaGFsbGVuZ2VQYXJhbS5yZXF1aXJlZEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyUmVxdWlyZWRBdHRyaWJ1dGVzID0gdGhpcy5jdXJyZW50VXNlci5jaGFsbGVuZ2VQYXJhbS5yZXF1aXJlZEF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlclJlcXVpcmVkQXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm1GaWVsZCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGF0dHJpYnV0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHJlcXVpcmVkQXR0cmlidXRlc01hcFthdHRyaWJ1dGVdLmxhYmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IHJlcXVpcmVkQXR0cmlidXRlc01hcFthdHRyaWJ1dGVdLnBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlUmVxdWlyZWRBdHRyaWJ1dGVJbnB1dENoYW5nZShhdHRyaWJ1dGUsIGV2ZW50KTsgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogXCJyZXF1aXJlLW5ldy1wYXNzd29yZC1cIiArIGF0dHJpYnV0ZSArIFwiLWlucHV0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5uZXdGb3JtRmllbGRzLnB1c2goZm9ybUZpZWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGFzc180LnByb3RvdHlwZS5oYW5kbGVQYXNzd29yZENoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLnBhc3N3b3JkID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIH07XG4gICAgY2xhc3NfNC5wcm90b3R5cGUuY29tcGxldGVOZXdQYXNzd29yZCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXNlciwgX2EsIGVycm9yXzc7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBdXRoIHx8IHR5cGVvZiBBdXRoLmNvbXBsZXRlTmV3UGFzc3dvcmQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9fQVVUSF9NT0RVTEVfRk9VTkQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudHJ5cy5wdXNoKFsxLCA4LCA5LCAxMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgQXV0aC5jb21wbGV0ZU5ld1Bhc3N3b3JkKHRoaXMuY3VycmVudFVzZXIsIHRoaXMucGFzc3dvcmQsIHRoaXMucmVxdWlyZWRBdHRyaWJ1dGVzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIkMS5kZWJ1ZygnY29tcGxldGUgbmV3IHBhc3N3b3JkJywgdXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHVzZXIuY2hhbGxlbmdlTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIENoYWxsZW5nZU5hbWUuU01TTUZBOiByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIENoYWxsZW5nZU5hbWUuTUZBU2V0dXA6IHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5Db25maXJtU2lnbkluLCB1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIkMS5kZWJ1ZygnVE9UUCBzZXR1cCcsIHVzZXIuY2hhbGxlbmdlUGFyYW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlRPVFBTZXR1cCwgdXNlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzQgLyp5aWVsZCovLCBjaGVja0NvbnRhY3QodXNlciwgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA3O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEwXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfNyA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoVG9hc3RIdWJFdmVudChlcnJvcl83KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDEwXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfNC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImFtcGxpZnktZm9ybS1zZWN0aW9uXCIsIHsgaGVhZGVyVGV4dDogSTE4bi5nZXQodGhpcy5oZWFkZXJUZXh0KSwgaGFuZGxlU3VibWl0OiB0aGlzLmhhbmRsZVN1Ym1pdCwgbG9hZGluZzogdGhpcy5sb2FkaW5nLCBzZWNvbmRhcnlGb290ZXJDb250ZW50OiBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25Jbik7IH0gfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkJBQ0tfVE9fU0lHTl9JTikpLCBzdWJtaXRCdXR0b25UZXh0OiBJMThuLmdldCh0aGlzLnN1Ym1pdEJ1dHRvblRleHQpIH0sIGgoXCJhbXBsaWZ5LWF1dGgtZmllbGRzXCIsIHsgZm9ybUZpZWxkczogdGhpcy5uZXdGb3JtRmllbGRzIH0pKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIGNsYXNzXzQ7XG59KCkpO1xudmFyIGFtcGxpZnlTaWduSW5Dc3MgPSBcIjpob3N0ey0tZm9vdGVyLXNpemU6dmFyKC0tYW1wbGlmeS10ZXh0LXNtKTstLWZvb3Rlci1jb2xvcjp2YXIoLS1hbXBsaWZ5LWdyZXkpOy0tZm9vdGVyLWZvbnQtZmFtaWx5OnZhcigtLWFtcGxpZnktZm9udC1mYW1pbHkpOy0tZm9udC13ZWlnaHQ6dmFyKC0tYW1wbGlmeS1mb250LXdlaWdodCl9LnNpZ24taW4tZm9ybS1mb290ZXJ7Zm9udC1mYW1pbHk6dmFyKC0tZm9vdGVyLWZvbnQtZmFtaWx5KTtmb250LXNpemU6dmFyKC0tZm9vdGVyLXNpemUpO2NvbG9yOnZhcigtLWZvb3Rlci1jb2xvcik7Zm9udC13ZWlnaHQ6LS1mb250LXdlaWdodDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstbXMtZmxleC1kaXJlY3Rpb246Y29sdW1uLXJldmVyc2U7ZmxleC1kaXJlY3Rpb246Y29sdW1uLXJldmVyc2U7LW1zLWZsZXgtYWxpZ246Y2VudGVyO2FsaWduLWl0ZW1zOmNlbnRlcjstbXMtZmxleC1wYWNrOmRpc3RyaWJ1dGU7anVzdGlmeS1jb250ZW50OnNwYWNlLWFyb3VuZH0uc2lnbi1pbi1mb3JtLWZvb3RlciBhbXBsaWZ5LWJ1dHRvbnttYXJnaW4tYm90dG9tOjAuNjI1cmVtfUBtZWRpYSAobWluLXdpZHRoOiA2NzJweCl7LnNpZ24taW4tZm9ybS1mb290ZXJ7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LW1zLWZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LWRpcmVjdGlvbjpyb3c7LW1zLWZsZXgtcGFjazpqdXN0aWZ5O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOy1tcy1mbGV4LWFsaWduOmJhc2VsaW5lO2FsaWduLWl0ZW1zOmJhc2VsaW5lfS5zaWduLWluLWZvcm0tZm9vdGVyIGFtcGxpZnktYnV0dG9ue21hcmdpbi1ib3R0b206MH19LnNpZ24taW4tZm9ybS1mb290ZXIgKisqe21hcmdpbi1ib3R0b206MTVweH1cIjtcbnZhciBBbXBsaWZ5U2lnbkluID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzUoaG9zdFJlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogRmlyZXMgd2hlbiBzaWduIGluIGZvcm0gaXMgc3VibWl0dGVkICovXG4gICAgICAgIHRoaXMuaGFuZGxlU3VibWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5zaWduSW4oZXZlbnQpOyB9O1xuICAgICAgICAvKiogVXNlZCBmb3IgaGVhZGVyIHRleHQgaW4gc2lnbiBpbiBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oZWFkZXJUZXh0ID0gVHJhbnNsYXRpb25zLlNJR05fSU5fSEVBREVSX1RFWFQ7XG4gICAgICAgIC8qKiBVc2VkIGZvciB0aGUgc3VibWl0IGJ1dHRvbiB0ZXh0IGluIHNpZ24gaW4gY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuc3VibWl0QnV0dG9uVGV4dCA9IFRyYW5zbGF0aW9ucy5TSUdOX0lOX0FDVElPTjtcbiAgICAgICAgLyoqIEF1dGggc3RhdGUgY2hhbmdlIGhhbmRsZXIgZm9yIHRoaXMgY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlID0gZGlzcGF0Y2hBdXRoU3RhdGVDaGFuZ2VFdmVudDtcbiAgICAgICAgLyoqIFVzZXJuYW1lIEFsaWFzIGlzIHVzZWQgdG8gc2V0dXAgYXV0aGVudGljYXRpb24gd2l0aCBgdXNlcm5hbWVgLCBgZW1haWxgIG9yIGBwaG9uZV9udW1iZXJgICAqL1xuICAgICAgICB0aGlzLnVzZXJuYW1lQWxpYXMgPSAndXNlcm5hbWUnO1xuICAgICAgICAvKipcbiAgICAgICAgICogRm9ybSBmaWVsZHMgYWxsb3dzIHlvdSB0byB1dGlsaXplIG91ciBwcmUtYnVpbHQgY29tcG9uZW50cyBzdWNoIGFzIHVzZXJuYW1lIGZpZWxkLCBjb2RlIGZpZWxkLCBwYXNzd29yZCBmaWVsZCwgZW1haWwgZmllbGQsIGV0Yy5cbiAgICAgICAgICogYnkgcGFzc2luZyBhbiBhcnJheSBvZiBzdHJpbmdzIHRoYXQgeW91IHdvdWxkIGxpa2UgdGhlIG9yZGVyIG9mIHRoZSBmb3JtIHRvIGJlIGluLiBJZiB5b3UgbmVlZCBtb3JlIGN1c3RvbWl6YXRpb24sIHN1Y2ggYXMgY2hhbmdpbmdcbiAgICAgICAgICogdGV4dCBmb3IgYSBsYWJlbCBvciBhZGp1c3QgYSBwbGFjZWhvbGRlciwgeW91IGNhbiBmb2xsb3cgdGhlIHN0cnVjdHVyZSBiZWxvdyBpbiBvcmRlciB0byBkbyBqdXN0IHRoYXQuXG4gICAgICAgICAqIGBgYFxuICAgICAgICAgKiBbXG4gICAgICAgICAqICB7XG4gICAgICAgICAqICAgIHR5cGU6IHN0cmluZyxcbiAgICAgICAgICogICAgbGFiZWw6IHN0cmluZyxcbiAgICAgICAgICogICAgcGxhY2Vob2xkZXI6IHN0cmluZyxcbiAgICAgICAgICogICAgaGludDogc3RyaW5nIHwgRnVuY3Rpb25hbCBDb21wb25lbnQgfCBudWxsLFxuICAgICAgICAgKiAgICByZXF1aXJlZDogYm9vbGVhblxuICAgICAgICAgKiAgfVxuICAgICAgICAgKiBdXG4gICAgICAgICAqIGBgYFxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5mb3JtRmllbGRzID0gW107XG4gICAgICAgIC8qKiBIaWRlcyB0aGUgc2lnbiB1cCBsaW5rICovXG4gICAgICAgIHRoaXMuaGlkZVNpZ25VcCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXTtcbiAgICAgICAgLyogV2hldGhlciBvciBub3QgdGhlIHNpZ24taW4gY29tcG9uZW50IGlzIGxvYWRpbmcgKi9cbiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSB7XG4gICAgICAgICAgICBjb3VudHJ5RGlhbENvZGVWYWx1ZTogQ09VTlRSWV9ESUFMX0NPREVfREVGQVVMVCxcbiAgICAgICAgICAgIHBob25lTnVtYmVyVmFsdWU6IG51bGwsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2lnbkluQXR0cmlidXRlcyA9IHtcbiAgICAgICAgICAgIHVzZXJJbnB1dDogJycsXG4gICAgICAgICAgICBwYXNzd29yZDogJycsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNsYXNzXzUucHJvdG90eXBlLmNvbXBvbmVudFdpbGxMb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja1VzZXJuYW1lQWxpYXModGhpcy51c2VybmFtZUFsaWFzKTtcbiAgICAgICAgdGhpcy5idWlsZEZvcm1GaWVsZHMoKTtcbiAgICB9O1xuICAgIGNsYXNzXzUucHJvdG90eXBlLmZvcm1GaWVsZHNIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmJ1aWxkRm9ybUZpZWxkcygpO1xuICAgIH07XG4gICAgY2xhc3NfNS5wcm90b3R5cGUuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoZmllbGRUeXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHN3aXRjaCAoZmllbGRUeXBlKSB7XG4gICAgICAgICAgICBjYXNlICd1c2VybmFtZSc6XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gKF90aGlzLnNpZ25JbkF0dHJpYnV0ZXMudXNlcklucHV0ID0gZXZlbnQudGFyZ2V0LnZhbHVlKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bob25lX251bWJlcic6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gaGFuZGxlUGhvbmVOdW1iZXJDaGFuZ2UoZXZlbnQsIF90aGlzLnBob25lTnVtYmVyKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiAoX3RoaXMuc2lnbkluQXR0cmlidXRlcy5wYXNzd29yZCA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzUucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0V2l0aENhbGxiYWNrID0gZnVuY3Rpb24gKGV2ZW50LCBmaWVsZCkge1xuICAgICAgICB2YXIgZm5Ub0NhbGwgPSBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgPyBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgOiBmdW5jdGlvbiAoZXZlbnQsIGNiKSB7XG4gICAgICAgICAgICAgICAgY2IoZXZlbnQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZShmaWVsZC50eXBlKTtcbiAgICAgICAgZm5Ub0NhbGwoZXZlbnQsIGNhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgIH07XG4gICAgY2xhc3NfNS5wcm90b3R5cGUuc2lnbkluID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGF2b2lkIHN1Ym1pdHRpbmcgdGhlIGZvcm1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJuYW1lQWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaWduSW5BdHRyaWJ1dGVzLnVzZXJJbnB1dCA9IGNvbXBvc2VQaG9uZU51bWJlcklucHV0KHRoaXMucGhvbmVOdW1iZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgaGFuZGxlU2lnbkluKHRoaXMuc2lnbkluQXR0cmlidXRlcy51c2VySW5wdXQsIHRoaXMuc2lnbkluQXR0cmlidXRlcy5wYXNzd29yZCwgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfNS5wcm90b3R5cGUuYnVpbGREZWZhdWx0Rm9ybUZpZWxkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGZvcm1GaWVsZElucHV0cyA9IFtdO1xuICAgICAgICBzd2l0Y2ggKHRoaXMudXNlcm5hbWVBbGlhcykge1xuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIGZvcm1GaWVsZElucHV0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VtYWlsJyxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdlbWFpbCcpLFxuICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24taW4tZW1haWwtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICBmb3JtRmllbGRJbnB1dHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwaG9uZV9udW1iZXInLFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3Bob25lX251bWJlcicpLFxuICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24taW4tcGhvbmUtbnVtYmVyLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3VzZXJuYW1lJzpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgZm9ybUZpZWxkSW5wdXRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAndXNlcm5hbWUnLFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3VzZXJuYW1lJyksXG4gICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi1pbi11c2VybmFtZS1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZm9ybUZpZWxkSW5wdXRzLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ3Bhc3N3b3JkJyxcbiAgICAgICAgICAgIGhpbnQ6IChoKFwiZGl2XCIsIG51bGwsIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5GT1JHT1RfUEFTU1dPUkRfVEVYVCksICcgJywgaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5Gb3Jnb3RQYXNzd29yZCk7IH0sIFwiZGF0YS10ZXN0XCI6IFwic2lnbi1pbi1mb3Jnb3QtcGFzc3dvcmQtbGlua1wiIH0sIEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5SRVNFVF9QQVNTV09SRF9URVhUKSkpKSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3Bhc3N3b3JkJyksXG4gICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLWluLXBhc3N3b3JkLWlucHV0JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBfX3NwcmVhZEFycmF5cyhmb3JtRmllbGRJbnB1dHMpO1xuICAgIH07XG4gICAgY2xhc3NfNS5wcm90b3R5cGUuYnVpbGRGb3JtRmllbGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5mb3JtRmllbGRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5idWlsZERlZmF1bHRGb3JtRmllbGRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgbmV3RmllbGRzXzIgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuZm9ybUZpZWxkcy5mb3JFYWNoKGZ1bmN0aW9uIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdGaWVsZCA9IE9iamVjdC5hc3NpZ24oe30sIGZpZWxkKTtcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBoYW5kbGUgaGludCBiZXR0ZXJcbiAgICAgICAgICAgICAgICBpZiAobmV3RmllbGQudHlwZSA9PT0gJ3Bhc3N3b3JkJykge1xuICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZFsnaGludCddID0gaXNIaW50VmFsaWQobmV3RmllbGQpID8gKGgoXCJkaXZcIiwgbnVsbCwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkZPUkdPVF9QQVNTV09SRF9URVhUKSwgJyAnLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLkZvcmdvdFBhc3N3b3JkKTsgfSwgXCJkYXRhLXRlc3RcIjogXCJzaWduLWluLWZvcmdvdC1wYXNzd29yZC1saW5rXCIgfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLlJFU0VUX1BBU1NXT1JEX1RFWFQpKSkpIDogKG5ld0ZpZWxkWydoaW50J10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuZXdGaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXSA9IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRXaXRoQ2FsbGJhY2soZXZlbnQsIGZpZWxkKTsgfTtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRGaWVsZFZhbHVlKG5ld0ZpZWxkLCBfdGhpcy5zaWduSW5BdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHNfMi5wdXNoKG5ld0ZpZWxkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5uZXdGb3JtRmllbGRzID0gbmV3RmllbGRzXzI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzUucHJvdG90eXBlLnNldEZpZWxkVmFsdWUgPSBmdW5jdGlvbiAoZmllbGQsIGZvcm1BdHRyaWJ1dGVzKSB7XG4gICAgICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIGlmIChmaWVsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLnVzZXJJbnB1dCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMudXNlcklucHV0ID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQuZGlhbENvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5waG9uZU51bWJlci5jb3VudHJ5RGlhbENvZGVWYWx1ZSA9IGZpZWxkLmRpYWxDb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBob25lTnVtYmVyLnBob25lTnVtYmVyVmFsdWUgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JtQXR0cmlidXRlcy5wYXNzd29yZCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMucGFzc3dvcmQgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzUucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhbXBsaWZ5LWZvcm0tc2VjdGlvblwiLCB7IGhlYWRlclRleHQ6IEkxOG4uZ2V0KHRoaXMuaGVhZGVyVGV4dCksIGhhbmRsZVN1Ym1pdDogdGhpcy5oYW5kbGVTdWJtaXQsIHRlc3REYXRhUHJlZml4OiAnc2lnbi1pbicgfSwgaChcImRpdlwiLCB7IHNsb3Q6IFwic3VidGl0bGVcIiB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiaGVhZGVyLXN1YnRpdGxlXCIgfSkpLCBoKFwic2xvdFwiLCB7IG5hbWU6IFwiZmVkZXJhdGVkLWJ1dHRvbnNcIiB9LCBoKFwiYW1wbGlmeS1mZWRlcmF0ZWQtYnV0dG9uc1wiLCB7IGhhbmRsZUF1dGhTdGF0ZUNoYW5nZTogdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UsIGZlZGVyYXRlZDogdGhpcy5mZWRlcmF0ZWQgfSkpLCAhaXNFbXB0eSh0aGlzLmZlZGVyYXRlZCkgJiYgaChcImFtcGxpZnktc3RyaWtlXCIsIG51bGwsIFwib3JcIiksIGgoXCJhbXBsaWZ5LWF1dGgtZmllbGRzXCIsIHsgZm9ybUZpZWxkczogdGhpcy5uZXdGb3JtRmllbGRzIH0pLCBoKFwiZGl2XCIsIHsgc2xvdDogXCJhbXBsaWZ5LWZvcm0tc2VjdGlvbi1mb290ZXJcIiwgY2xhc3M6IFwic2lnbi1pbi1mb3JtLWZvb3RlclwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJmb290ZXJcIiB9LCBoKFwic2xvdFwiLCB7IG5hbWU6IFwic2Vjb25kYXJ5LWZvb3Rlci1jb250ZW50XCIgfSwgIXRoaXMuaGlkZVNpZ25VcCA/IChoKFwic3BhblwiLCBudWxsLCBJMThuLmdldChUcmFuc2xhdGlvbnMuTk9fQUNDT1VOVF9URVhUKSwgJyAnLCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB2YXJpYW50OiBcImFuY2hvclwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25VcCk7IH0sIFwiZGF0YS10ZXN0XCI6IFwic2lnbi1pbi1jcmVhdGUtYWNjb3VudC1saW5rXCIgfSwgSTE4bi5nZXQoVHJhbnNsYXRpb25zLkNSRUFURV9BQ0NPVU5UX1RFWFQpKSkpIDogKGgoXCJzcGFuXCIsIG51bGwpKSksIGgoXCJzbG90XCIsIHsgbmFtZTogXCJwcmltYXJ5LWZvb3Rlci1jb250ZW50XCIgfSwgaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdHlwZTogXCJzdWJtaXRcIiwgZGlzYWJsZWQ6IHRoaXMubG9hZGluZywgXCJkYXRhLXRlc3RcIjogXCJzaWduLWluLXNpZ24taW4tYnV0dG9uXCIgfSwgdGhpcy5sb2FkaW5nID8gaChcImFtcGxpZnktbG9hZGluZy1zcGlubmVyXCIsIG51bGwpIDogaChcInNwYW5cIiwgbnVsbCwgSTE4bi5nZXQodGhpcy5zdWJtaXRCdXR0b25UZXh0KSkpKSkpKSkpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsYXNzXzUsIFwid2F0Y2hlcnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgXCJmb3JtRmllbGRzXCI6IFtcImZvcm1GaWVsZHNIYW5kbGVyXCJdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGNsYXNzXzU7XG59KCkpO1xuQW1wbGlmeVNpZ25Jbi5zdHlsZSA9IGFtcGxpZnlTaWduSW5Dc3M7XG52YXIgYW1wbGlmeVNpZ25VcENzcyA9IFwiOmhvc3R7LS1mb290ZXItZm9udC1mYW1pbHk6dmFyKC0tYW1wbGlmeS1mb250LWZhbWlseSk7LS1mb290ZXItZm9udC1zaXplOnZhcigtLWFtcGxpZnktdGV4dC1zbSk7LS1mb290ZXItY29sb3I6dmFyKC0tYW1wbGlmeS1ncmV5KTstLWZvbnQtd2VpZ2h0OnZhcigtLWFtcGxpZnktZm9udC13ZWlnaHQpfS5zaWduLXVwLWZvcm0tZm9vdGVye2ZvbnQtZmFtaWx5OnZhcigtLWZvb3Rlci1mb250LWZhbWlseSk7Zm9udC1zaXplOnZhcigtLWZvb3Rlci1mb250LXNpemUpO2NvbG9yOnZhcigtLWZvb3Rlci1jb2xvcik7Zm9udC13ZWlnaHQ6LS1mb250LXdlaWdodDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstbXMtZmxleC1kaXJlY3Rpb246Y29sdW1uLXJldmVyc2U7ZmxleC1kaXJlY3Rpb246Y29sdW1uLXJldmVyc2U7LW1zLWZsZXgtYWxpZ246Y2VudGVyO2FsaWduLWl0ZW1zOmNlbnRlcjstbXMtZmxleC1wYWNrOmRpc3RyaWJ1dGU7anVzdGlmeS1jb250ZW50OnNwYWNlLWFyb3VuZH0uc2lnbi11cC1mb3JtLWZvb3RlciBhbXBsaWZ5LWJ1dHRvbnttYXJnaW4tYm90dG9tOjAuNjI1cmVtfUBtZWRpYSAobWluLXdpZHRoOiA2NzJweCl7LnNpZ24tdXAtZm9ybS1mb290ZXJ7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LW1zLWZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LWRpcmVjdGlvbjpyb3c7LW1zLWZsZXgtcGFjazpqdXN0aWZ5O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOy1tcy1mbGV4LWFsaWduOmJhc2VsaW5lO2FsaWduLWl0ZW1zOmJhc2VsaW5lfS5zaWduLXVwLWZvcm0tZm9vdGVyIGFtcGxpZnktYnV0dG9ue21hcmdpbi1ib3R0b206MH19LnNpZ24tdXAtZm9ybS1mb290ZXIgKisqe21hcmdpbi1ib3R0b206MTVweH1cIjtcbnZhciBBbXBsaWZ5U2lnblVwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzYoaG9zdFJlZikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogRmlyZXMgd2hlbiBzaWduIHVwIGZvcm0gaXMgc3VibWl0dGVkICovXG4gICAgICAgIHRoaXMuaGFuZGxlU3VibWl0ID0gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5zaWduVXAoZXZlbnQpOyB9O1xuICAgICAgICAvKiogVXNlZCBmb3IgaGVhZGVyIHRleHQgaW4gc2lnbiB1cCBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oZWFkZXJUZXh0ID0gVHJhbnNsYXRpb25zLlNJR05fVVBfSEVBREVSX1RFWFQ7XG4gICAgICAgIC8qKiBVc2VkIGZvciB0aGUgc3VibWl0IGJ1dHRvbiB0ZXh0IGluIHNpZ24gdXAgY29tcG9uZW50ICovXG4gICAgICAgIHRoaXMuc3VibWl0QnV0dG9uVGV4dCA9IFRyYW5zbGF0aW9ucy5TSUdOX1VQX1NVQk1JVF9CVVRUT05fVEVYVDtcbiAgICAgICAgLyoqIFVzZWQgZm9yIHRoZSBzdWJtaXQgYnV0dG9uIHRleHQgaW4gc2lnbiB1cCBjb21wb25lbnQgKi9cbiAgICAgICAgdGhpcy5oYXZlQWNjb3VudFRleHQgPSBUcmFuc2xhdGlvbnMuU0lHTl9VUF9IQVZFX0FDQ09VTlRfVEVYVDtcbiAgICAgICAgLyoqIFRleHQgdXNlZCBmb3IgdGhlIHNpZ24gaW4gaHlwZXJsaW5rICovXG4gICAgICAgIHRoaXMuc2lnbkluVGV4dCA9IFRyYW5zbGF0aW9ucy5TSUdOX0lOX1RFWFQ7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGb3JtIGZpZWxkcyBhbGxvd3MgeW91IHRvIHV0aWxpemUgb3VyIHByZS1idWlsdCBjb21wb25lbnRzIHN1Y2ggYXMgdXNlcm5hbWUgZmllbGQsIGNvZGUgZmllbGQsIHBhc3N3b3JkIGZpZWxkLCBlbWFpbCBmaWVsZCwgZXRjLlxuICAgICAgICAgKiBieSBwYXNzaW5nIGFuIGFycmF5IG9mIHN0cmluZ3MgdGhhdCB5b3Ugd291bGQgbGlrZSB0aGUgb3JkZXIgb2YgdGhlIGZvcm0gdG8gYmUgaW4uIElmIHlvdSBuZWVkIG1vcmUgY3VzdG9taXphdGlvbiwgc3VjaCBhcyBjaGFuZ2luZ1xuICAgICAgICAgKiB0ZXh0IGZvciBhIGxhYmVsIG9yIGFkanVzdCBhIHBsYWNlaG9sZGVyLCB5b3UgY2FuIGZvbGxvdyB0aGUgc3RydWN0dXJlIGJlbG93IGluIG9yZGVyIHRvIGRvIGp1c3QgdGhhdC5cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqIFtcbiAgICAgICAgICogIHtcbiAgICAgICAgICogICAgdHlwZTogc3RyaW5nLFxuICAgICAgICAgKiAgICBsYWJlbDogc3RyaW5nLFxuICAgICAgICAgKiAgICBwbGFjZWhvbGRlcjogc3RyaW5nLFxuICAgICAgICAgKiAgICBoaW50OiBzdHJpbmcgfCBGdW5jdGlvbmFsIENvbXBvbmVudCB8IG51bGwsXG4gICAgICAgICAqICAgIHJlcXVpcmVkOiBib29sZWFuXG4gICAgICAgICAqICB9XG4gICAgICAgICAqIF1cbiAgICAgICAgICogYGBgXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmZvcm1GaWVsZHMgPSBbXTtcbiAgICAgICAgLyoqIEF1dGggc3RhdGUgY2hhbmdlIGhhbmRsZXIgZm9yIHRoaXMgY29tcG9uZW50XG4gICAgICAgICAqIGUuZy4gU2lnbkluIC0+ICdDcmVhdGUgQWNjb3VudCcgbGluayAtPiBTaWduVXBcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlID0gZGlzcGF0Y2hBdXRoU3RhdGVDaGFuZ2VFdmVudDtcbiAgICAgICAgLyoqIFVzZXJuYW1lIEFsaWFzIGlzIHVzZWQgdG8gc2V0dXAgYXV0aGVudGljYXRpb24gd2l0aCBgdXNlcm5hbWVgLCBgZW1haWxgIG9yIGBwaG9uZV9udW1iZXJgICAqL1xuICAgICAgICB0aGlzLnVzZXJuYW1lQWxpYXMgPSAndXNlcm5hbWUnO1xuICAgICAgICAvLyBwcml2YXRlIHVzZXJJbnB1dDogc3RyaW5nIHwgUGhvbmVOdW1iZXJJbnRlcmZhY2U7XG4gICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IFtdO1xuICAgICAgICB0aGlzLnBob25lTnVtYmVyID0ge1xuICAgICAgICAgICAgY291bnRyeURpYWxDb2RlVmFsdWU6IENPVU5UUllfRElBTF9DT0RFX0RFRkFVTFQsXG4gICAgICAgICAgICBwaG9uZU51bWJlclZhbHVlOiBudWxsLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zaWduVXBBdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6ICcnLFxuICAgICAgICAgICAgcGFzc3dvcmQ6ICcnLFxuICAgICAgICAgICAgYXR0cmlidXRlczoge30sXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNsYXNzXzYucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlID0gZnVuY3Rpb24gKGZpZWxkVHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBzd2l0Y2ggKGZpZWxkVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5zaWduVXBBdHRyaWJ1dGVzLnVzZXJuYW1lID0gZXZlbnQudGFyZ2V0LnZhbHVlKTsgfTtcbiAgICAgICAgICAgIGNhc2UgJ3Bhc3N3b3JkJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiAoX3RoaXMuc2lnblVwQXR0cmlidXRlcy5wYXNzd29yZCA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgICAgICBjYXNlICdlbWFpbCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gKF90aGlzLnNpZ25VcEF0dHJpYnV0ZXMuYXR0cmlidXRlcy5lbWFpbCA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIGhhbmRsZVBob25lTnVtYmVyQ2hhbmdlKGV2ZW50LCBfdGhpcy5waG9uZU51bWJlcik7IH07XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIChfdGhpcy5zaWduVXBBdHRyaWJ1dGVzLmF0dHJpYnV0ZXNbZmllbGRUeXBlXSA9IGV2ZW50LnRhcmdldC52YWx1ZSk7IH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzYucHJvdG90eXBlLmhhbmRsZUZvcm1GaWVsZElucHV0V2l0aENhbGxiYWNrID0gZnVuY3Rpb24gKGV2ZW50LCBmaWVsZCkge1xuICAgICAgICB2YXIgZm5Ub0NhbGwgPSBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgPyBmaWVsZFsnaGFuZGxlSW5wdXRDaGFuZ2UnXVxuICAgICAgICAgICAgOiBmdW5jdGlvbiAoZXZlbnQsIGNiKSB7XG4gICAgICAgICAgICAgICAgY2IoZXZlbnQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZShmaWVsZC50eXBlKTtcbiAgICAgICAgZm5Ub0NhbGwoZXZlbnQsIGNhbGxiYWNrLmJpbmQodGhpcykpO1xuICAgIH07XG4gICAgLy8gVE9ETzogQWRkIHZhbGlkYXRpb25cbiAgICAvLyBUT0RPOiBQcmVmaXhcbiAgICBjbGFzc182LnByb3RvdHlwZS5zaWduVXAgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRhdGEsIHNpZ25VcEF0dHJzLCBlcnJvcl84O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5zaWduVXAgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9fQVVUSF9NT0RVTEVfRk9VTkQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGhvbmVOdW1iZXIucGhvbmVOdW1iZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnblVwQXR0cmlidXRlcy5hdHRyaWJ1dGVzLnBob25lX251bWJlciA9IGNvbXBvc2VQaG9uZU51bWJlcklucHV0KHRoaXMucGhvbmVOdW1iZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHRoaXMudXNlcm5hbWVBbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwaG9uZV9udW1iZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpZ25VcEF0dHJpYnV0ZXMudXNlcm5hbWUgPSB0aGlzLnNpZ25VcEF0dHJpYnV0ZXMuYXR0cmlidXRlc1t0aGlzLnVzZXJuYW1lQWxpYXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCA2LCAsIDddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGguc2lnblVwKHRoaXMuc2lnblVwQXR0cmlidXRlcyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFRyYW5zbGF0aW9ucy5TSUdOX1VQX0ZBSUxFRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEudXNlckNvbmZpcm1lZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBoYW5kbGVTaWduSW4odGhpcy5zaWduVXBBdHRyaWJ1dGVzLnVzZXJuYW1lLCB0aGlzLnNpZ25VcEF0dHJpYnV0ZXMucGFzc3dvcmQsIHRoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBzaWduVXBBdHRycyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuc2lnblVwQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuQ29uZmlybVNpZ25VcCwgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBkYXRhLnVzZXIpLCB7IHNpZ25VcEF0dHJzOiBzaWduVXBBdHRycyB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzggPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfOCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuYnVpbGREZWZhdWx0Rm9ybUZpZWxkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJuYW1lQWxpYXMpIHtcbiAgICAgICAgICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlbWFpbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNJR05fVVBfRU1BSUxfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgnZW1haWwnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtZW1haWwtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBJMThuLmdldChUcmFuc2xhdGlvbnMuU0lHTl9VUF9QQVNTV09SRF9QTEFDRUhPTERFUiksXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdwYXNzd29yZCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi11cC1wYXNzd29yZC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGhvbmVfbnVtYmVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3Bob25lX251bWJlcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi11cC1waG9uZS1udW1iZXItaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGhvbmVfbnVtYmVyJzpcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwaG9uZV9udW1iZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgncGhvbmVfbnVtYmVyJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLXVwLXBob25lLW51bWJlci1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncGFzc3dvcmQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5TSUdOX1VQX1BBU1NXT1JEX1BMQUNFSE9MREVSKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ3Bhc3N3b3JkJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLXVwLXBhc3N3b3JkLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlbWFpbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNJR05fVVBfRU1BSUxfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgnZW1haWwnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtZW1haWwtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndXNlcm5hbWUnOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aGlzLm5ld0Zvcm1GaWVsZHMgPSBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICd1c2VybmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlNJR05fVVBfVVNFUk5BTUVfUExBQ0VIT0xERVIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgndXNlcm5hbWUnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YS10ZXN0JzogJ3NpZ24tdXAtdXNlcm5hbWUtaW5wdXQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bhc3N3b3JkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBJMThuLmdldChUcmFuc2xhdGlvbnMuU0lHTl9VUF9QQVNTV09SRF9QTEFDRUhPTERFUiksXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUlucHV0Q2hhbmdlOiB0aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0Q2hhbmdlKCdwYXNzd29yZCcpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAnc2lnbi11cC1wYXNzd29yZC1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW1haWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5TSUdOX1VQX0VNQUlMX1BMQUNFSE9MREVSKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlSW5wdXRDaGFuZ2U6IHRoaXMuaGFuZGxlRm9ybUZpZWxkSW5wdXRDaGFuZ2UoJ2VtYWlsJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLXVwLWVtYWlsLWlucHV0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdwaG9uZV9udW1iZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVJbnB1dENoYW5nZTogdGhpcy5oYW5kbGVGb3JtRmllbGRJbnB1dENoYW5nZSgncGhvbmVfbnVtYmVyJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICdzaWduLXVwLXBob25lLW51bWJlci1pbnB1dCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNsYXNzXzYucHJvdG90eXBlLmJ1aWxkRm9ybUZpZWxkcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuZm9ybUZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuYnVpbGREZWZhdWx0Rm9ybUZpZWxkcygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG5ld0ZpZWxkc18zID0gW107XG4gICAgICAgICAgICB0aGlzLmZvcm1GaWVsZHMuZm9yRWFjaChmdW5jdGlvbiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3RmllbGQgPSBPYmplY3QuYXNzaWduKHt9LCBmaWVsZCk7XG4gICAgICAgICAgICAgICAgbmV3RmllbGRbJ2hhbmRsZUlucHV0Q2hhbmdlJ10gPSBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUZvcm1GaWVsZElucHV0V2l0aENhbGxiYWNrKGV2ZW50LCBmaWVsZCk7IH07XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0RmllbGRWYWx1ZShmaWVsZCwgX3RoaXMuc2lnblVwQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgbmV3RmllbGRzXzMucHVzaChuZXdGaWVsZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubmV3Rm9ybUZpZWxkcyA9IG5ld0ZpZWxkc18zO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc182LnByb3RvdHlwZS5zZXRGaWVsZFZhbHVlID0gZnVuY3Rpb24gKGZpZWxkLCBmb3JtQXR0cmlidXRlcykge1xuICAgICAgICBzd2l0Y2ggKGZpZWxkLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3VzZXJuYW1lJzpcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3JtQXR0cmlidXRlcy51c2VybmFtZSA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMudXNlcm5hbWUgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwYXNzd29yZCc6XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybUF0dHJpYnV0ZXMucGFzc3dvcmQgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLnBhc3N3b3JkID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZW1haWwnOlxuICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLmF0dHJpYnV0ZXMuZW1haWwgPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Bob25lX251bWJlcic6XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLmRpYWxDb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGhvbmVOdW1iZXIuY291bnRyeURpYWxDb2RlVmFsdWUgPSBmaWVsZC5kaWFsQ29kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5waG9uZU51bWJlci5waG9uZU51bWJlclZhbHVlID0gZmllbGQudmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGZvcm1BdHRyaWJ1dGVzLmF0dHJpYnV0ZXNbZmllbGQudHlwZV0gPSBmaWVsZC52YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuY29tcG9uZW50V2lsbExvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrVXNlcm5hbWVBbGlhcyh0aGlzLnVzZXJuYW1lQWxpYXMpO1xuICAgICAgICB0aGlzLmJ1aWxkRm9ybUZpZWxkcygpO1xuICAgIH07XG4gICAgY2xhc3NfNi5wcm90b3R5cGUuZm9ybUZpZWxkc0hhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYnVpbGRGb3JtRmllbGRzKCk7XG4gICAgfTtcbiAgICBjbGFzc182LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoaChIb3N0LCBudWxsLCBoKFwiYW1wbGlmeS1mb3JtLXNlY3Rpb25cIiwgeyBoZWFkZXJUZXh0OiBJMThuLmdldCh0aGlzLmhlYWRlclRleHQpLCBoYW5kbGVTdWJtaXQ6IHRoaXMuaGFuZGxlU3VibWl0LCB0ZXN0RGF0YVByZWZpeDogJ3NpZ24tdXAnIH0sIGgoXCJkaXZcIiwgeyBzbG90OiBcInN1YnRpdGxlXCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImhlYWRlci1zdWJ0aXRsZVwiIH0pKSwgaChcImFtcGxpZnktYXV0aC1maWVsZHNcIiwgeyBmb3JtRmllbGRzOiB0aGlzLm5ld0Zvcm1GaWVsZHMgfSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJzaWduLXVwLWZvcm0tZm9vdGVyXCIsIHNsb3Q6IFwiYW1wbGlmeS1mb3JtLXNlY3Rpb24tZm9vdGVyXCIgfSwgaChcInNsb3RcIiwgeyBuYW1lOiBcImZvb3RlclwiIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogXCJzZWNvbmRhcnktZm9vdGVyLWNvbnRlbnRcIiB9LCBoKFwic3BhblwiLCBudWxsLCBJMThuLmdldCh0aGlzLmhhdmVBY2NvdW50VGV4dCksICcgJywgaChcImFtcGxpZnktYnV0dG9uXCIsIHsgdmFyaWFudDogXCJhbmNob3JcIiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5TaWduSW4pOyB9LCBcImRhdGEtdGVzdFwiOiBcInNpZ24tdXAtc2lnbi1pbi1saW5rXCIgfSwgSTE4bi5nZXQodGhpcy5zaWduSW5UZXh0KSkpKSwgaChcInNsb3RcIiwgeyBuYW1lOiBcInByaW1hcnktZm9vdGVyLWNvbnRlbnRcIiB9LCBoKFwiYW1wbGlmeS1idXR0b25cIiwgeyB0eXBlOiBcInN1Ym1pdFwiLCBcImRhdGEtdGVzdFwiOiBcInNpZ24tdXAtY3JlYXRlLWFjY291bnQtYnV0dG9uXCIgfSwgdGhpcy5sb2FkaW5nID8gaChcImFtcGxpZnktbG9hZGluZy1zcGlubmVyXCIsIG51bGwpIDogaChcInNwYW5cIiwgbnVsbCwgSTE4bi5nZXQodGhpcy5zdWJtaXRCdXR0b25UZXh0KSkpKSkpKSkpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsYXNzXzYsIFwid2F0Y2hlcnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgXCJmb3JtRmllbGRzXCI6IFtcImZvcm1GaWVsZHNIYW5kbGVyXCJdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGNsYXNzXzY7XG59KCkpO1xuQW1wbGlmeVNpZ25VcC5zdHlsZSA9IGFtcGxpZnlTaWduVXBDc3M7XG52YXIgbG9nZ2VyJDIgPSBuZXcgTG9nZ2VyKCdBbXBsaWZ5VmVyaWZ5Q29udGFjdCcpO1xudmFyIEFtcGxpZnlWZXJpZnlDb250YWN0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzcoaG9zdFJlZikge1xuICAgICAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgICAgICAvKiogQXV0aGVudGljYXRpb24gc3RhdGUgaGFuZGxlciAqL1xuICAgICAgICB0aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZSA9IGRpc3BhdGNoQXV0aFN0YXRlQ2hhbmdlRXZlbnQ7XG4gICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBjbGFzc183LnByb3RvdHlwZS5oYW5kbGVTdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy52ZXJpZnlBdHRyID8gdGhpcy5zdWJtaXQodGhpcy5jb2RlKSA6IHRoaXMudmVyaWZ5KHRoaXMuY29udGFjdCk7XG4gICAgfTtcbiAgICBjbGFzc183LnByb3RvdHlwZS5zdWJtaXQgPSBmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXR0ciwgZGF0YSwgZXJyb3JfOTtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHIgPSB0aGlzLnZlcmlmeUF0dHI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUF1dGggfHwgdHlwZW9mIEF1dGgudmVyaWZ5Q3VycmVudFVzZXJBdHRyaWJ1dGVTdWJtaXQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9fQVVUSF9NT0RVTEVfRk9VTkQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCAzLCA0LCA1XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBBdXRoLnZlcmlmeUN1cnJlbnRVc2VyQXR0cmlidXRlU3VibWl0KGF0dHIsIGNvZGUpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlciQyLmRlYnVnKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlNpZ25lZEluLCB0aGlzLnVzZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJpZnlBdHRyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl85ID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyJDIuZXJyb3IoZXJyb3JfOSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGFzc183LnByb3RvdHlwZS52ZXJpZnkgPSBmdW5jdGlvbiAoY29udGFjdCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSwgZXJyb3JfMTA7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRhY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIkMi5lcnJvcignTmVpdGhlciBFbWFpbCBub3IgUGhvbmUgTnVtYmVyIHNlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBdXRoIHx8IHR5cGVvZiBBdXRoLnZlcmlmeUN1cnJlbnRVc2VyQXR0cmlidXRlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgNCwgNV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgQXV0aC52ZXJpZnlDdXJyZW50VXNlckF0dHJpYnV0ZShjb250YWN0KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIkMi5kZWJ1ZyhkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmVyaWZ5QXR0ciA9IGNvbnRhY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfMTAgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyJDIuZXJyb3IoZXJyb3JfMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgY2xhc3NfNy5wcm90b3R5cGUuaGFuZGxlSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdmFyIGlucHV0TmFtZSA9IGV2ZW50LnRhcmdldC5uYW1lO1xuICAgICAgICBpZiAoaW5wdXROYW1lID09PSAnY29kZScpIHtcbiAgICAgICAgICAgIHRoaXMuY29kZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpbnB1dE5hbWUgPT09ICdjb250YWN0Jykge1xuICAgICAgICAgICAgdGhpcy5jb250YWN0ID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjbGFzc183LnByb3RvdHlwZS5yZW5kZXJTdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoaChcImRpdlwiLCBudWxsLCBoKFwiYW1wbGlmeS1pbnB1dFwiLCB7IGlucHV0UHJvcHM6IHtcbiAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU6ICdvZmYnLFxuICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAndmVyaWZ5LWNvbnRhY3QtY29kZS1pbnB1dCcsXG4gICAgICAgICAgICB9LCBuYW1lOiBcImNvZGVcIiwgcGxhY2Vob2xkZXI6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5DT0RFX1BMQUNFSE9MREVSKSwgaGFuZGxlSW5wdXRDaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlSW5wdXRDaGFuZ2UoZXZlbnQpOyB9IH0pKSk7XG4gICAgfTtcbiAgICBjbGFzc183LnByb3RvdHlwZS5yZW5kZXJWZXJpZnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB1c2VyID0gdGhpcy51c2VyO1xuICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIGxvZ2dlciQyLmRlYnVnKCdObyB1c2VyIHRvIHZlcmlmeScpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHVudmVyaWZpZWQgPSB1c2VyLnVudmVyaWZpZWQ7XG4gICAgICAgIGlmICghdW52ZXJpZmllZCkge1xuICAgICAgICAgICAgbG9nZ2VyJDIuZGVidWcoJ1VudmVyaWZpZWQgdmFyaWFibGUgZG9lcyBub3QgZXhpc3Qgb24gdXNlcicpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVtYWlsID0gdW52ZXJpZmllZC5lbWFpbCwgcGhvbmVfbnVtYmVyID0gdW52ZXJpZmllZC5waG9uZV9udW1iZXI7XG4gICAgICAgIHJldHVybiAoaChcImRpdlwiLCBudWxsLCBlbWFpbCAmJiAoaChcImFtcGxpZnktcmFkaW8tYnV0dG9uXCIsIHsgbGFiZWw6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5WRVJJRllfQ09OVEFDVF9FTUFJTF9MQUJFTCksIGtleTogXCJlbWFpbFwiLCBuYW1lOiBcImNvbnRhY3RcIiwgdmFsdWU6IFwiZW1haWxcIiwgaGFuZGxlSW5wdXRDaGFuZ2U6IGZ1bmN0aW9uIChldmVudCkgeyByZXR1cm4gX3RoaXMuaGFuZGxlSW5wdXRDaGFuZ2UoZXZlbnQpOyB9LCBpbnB1dFByb3BzOiB7XG4gICAgICAgICAgICAgICAgJ2RhdGEtdGVzdCc6ICd2ZXJpZnktY29udGFjdC1lbWFpbC1yYWRpbycsXG4gICAgICAgICAgICB9IH0pKSwgcGhvbmVfbnVtYmVyICYmIChoKFwiYW1wbGlmeS1yYWRpby1idXR0b25cIiwgeyBsYWJlbDogSTE4bi5nZXQoVHJhbnNsYXRpb25zLlZFUklGWV9DT05UQUNUX1BIT05FX0xBQkVMKSwga2V5OiBcInBob25lX251bWJlclwiLCBuYW1lOiBcImNvbnRhY3RcIiwgdmFsdWU6IFwicGhvbmVfbnVtYmVyXCIsIGhhbmRsZUlucHV0Q2hhbmdlOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUlucHV0Q2hhbmdlKGV2ZW50KTsgfSwgaW5wdXRQcm9wczoge1xuICAgICAgICAgICAgICAgICdkYXRhLXRlc3QnOiAndmVyaWZ5LWNvbnRhY3QtZW1haWwtcmFkaW8nLFxuICAgICAgICAgICAgfSB9KSkpKTtcbiAgICB9O1xuICAgIGNsYXNzXzcucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhbXBsaWZ5LWZvcm0tc2VjdGlvblwiLCB7IGhhbmRsZVN1Ym1pdDogZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVTdWJtaXQoZXZlbnQpOyB9LCBoZWFkZXJUZXh0OiBJMThuLmdldChUcmFuc2xhdGlvbnMuVkVSSUZZX0NPTlRBQ1RfSEVBREVSX1RFWFQpLCBsb2FkaW5nOiB0aGlzLmxvYWRpbmcsIHNlY29uZGFyeUZvb3RlckNvbnRlbnQ6IGgoXCJzcGFuXCIsIG51bGwsIGgoXCJhbXBsaWZ5LWJ1dHRvblwiLCB7IHZhcmlhbnQ6IFwiYW5jaG9yXCIsIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuU2lnbmVkSW4sIF90aGlzLnVzZXIpOyB9IH0sIFwiU2tpcFwiKSksIHN1Ym1pdEJ1dHRvblRleHQ6IHRoaXMudmVyaWZ5QXR0clxuICAgICAgICAgICAgICAgID8gSTE4bi5nZXQoVHJhbnNsYXRpb25zLlZFUklGWV9DT05UQUNUX1NVQk1JVF9MQUJFTClcbiAgICAgICAgICAgICAgICA6IEkxOG4uZ2V0KFRyYW5zbGF0aW9ucy5WRVJJRllfQ09OVEFDVF9WRVJJRllfTEFCRUwpIH0sIHRoaXMudmVyaWZ5QXR0ciA/IHRoaXMucmVuZGVyU3VibWl0KCkgOiB0aGlzLnJlbmRlclZlcmlmeSgpKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIGNsYXNzXzc7XG59KCkpO1xuZXhwb3J0IHsgQW1wbGlmeUNvbmZpcm1TaWduSW4gYXMgYW1wbGlmeV9jb25maXJtX3NpZ25faW4sIEFtcGxpZnlDb25maXJtU2lnblVwIGFzIGFtcGxpZnlfY29uZmlybV9zaWduX3VwLCBBbXBsaWZ5Rm9yZ290UGFzc3dvcmQgYXMgYW1wbGlmeV9mb3Jnb3RfcGFzc3dvcmQsIEFtcGxpZnlSZXF1aXJlTmV3UGFzc3dvcmQgYXMgYW1wbGlmeV9yZXF1aXJlX25ld19wYXNzd29yZCwgQW1wbGlmeVNpZ25JbiBhcyBhbXBsaWZ5X3NpZ25faW4sIEFtcGxpZnlTaWduVXAgYXMgYW1wbGlmeV9zaWduX3VwLCBBbXBsaWZ5VmVyaWZ5Q29udGFjdCBhcyBhbXBsaWZ5X3ZlcmlmeV9jb250YWN0IH07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@aws-amplify/ui-components/dist/esm-es5/amplify-confirm-sign-in_7.entry.js\n");

/***/ }),

/***/ "./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-442d4bea.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-442d4bea.js ***!
  \***************************************************************************************/
/*! exports provided: c, h */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return checkContact; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"h\", function() { return handleSignIn; });\n/* harmony import */ var _aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-amplify/core */ \"./node_modules/@aws-amplify/core/lib-esm/index.js\");\n/* harmony import */ var _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth-types-78df304e.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-types-78df304e.js\");\n/* harmony import */ var _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aws-amplify/auth */ \"./node_modules/@aws-amplify/auth/lib-esm/index.js\");\n/* harmony import */ var _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Translations-71acc661.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/Translations-71acc661.js\");\n/* harmony import */ var _constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./constants-d1abe7de.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/constants-d1abe7de.js\");\n/* harmony import */ var _helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./helpers-03bb6a38.js */ \"./node_modules/@aws-amplify/ui-components/dist/esm-es5/helpers-03bb6a38.js\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\n\n\n\n\n\nvar logger = new _aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__[\"Logger\"]('auth-helpers');\nfunction checkContact(user, handleAuthStateChange) {\n    return __awaiter(this, void 0, void 0, function () {\n        var data, newUser, error_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__[\"Auth\"].verifiedContact !== 'function') {\n                        throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_4__[\"N\"]);\n                    }\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__[\"Auth\"].verifiedContact(user)];\n                case 2:\n                    data = _a.sent();\n                    if (!Object(_aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__[\"isEmpty\"])(data.verified) || Object(_aws_amplify_core__WEBPACK_IMPORTED_MODULE_0__[\"isEmpty\"])(data.unverified)) {\n                        handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].SignedIn, user);\n                    }\n                    else {\n                        newUser = Object.assign(user, data);\n                        handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].VerifyContact, newUser);\n                    }\n                    return [3 /*break*/, 4];\n                case 3:\n                    error_1 = _a.sent();\n                    Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_5__[\"a\"])(error_1);\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n}\nvar handleSignIn = function (username, password, handleAuthStateChange) { return __awaiter(void 0, void 0, void 0, function () {\n    var user, error_2;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                if (!_aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__[\"Auth\"] || typeof _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__[\"Auth\"].signIn !== 'function') {\n                    throw new Error(_constants_d1abe7de_js__WEBPACK_IMPORTED_MODULE_4__[\"N\"]);\n                }\n                _a.label = 1;\n            case 1:\n                _a.trys.push([1, 9, , 10]);\n                return [4 /*yield*/, _aws_amplify_auth__WEBPACK_IMPORTED_MODULE_2__[\"Auth\"].signIn(username, password)];\n            case 2:\n                user = _a.sent();\n                logger.debug(user);\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"C\"].SMSMFA || user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"C\"].SoftwareTokenMFA)) return [3 /*break*/, 3];\n                logger.debug('confirm user with ' + user.challengeName);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].ConfirmSignIn, user);\n                return [3 /*break*/, 8];\n            case 3:\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"C\"].NewPasswordRequired)) return [3 /*break*/, 4];\n                logger.debug('require new password', user.challengeParam);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].ResetPassword, user);\n                return [3 /*break*/, 8];\n            case 4:\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"C\"].MFASetup)) return [3 /*break*/, 5];\n                logger.debug('TOTP setup', user.challengeParam);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].TOTPSetup, user);\n                return [3 /*break*/, 8];\n            case 5:\n                if (!(user.challengeName === _auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"C\"].CustomChallenge &&\n                    user.challengeParam &&\n                    user.challengeParam.trigger === 'true')) return [3 /*break*/, 6];\n                logger.debug('custom challenge', user.challengeParam);\n                handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].CustomConfirmSignIn, user);\n                return [3 /*break*/, 8];\n            case 6: return [4 /*yield*/, checkContact(user, handleAuthStateChange)];\n            case 7:\n                _a.sent();\n                _a.label = 8;\n            case 8: return [3 /*break*/, 10];\n            case 9:\n                error_2 = _a.sent();\n                if (error_2.code === 'UserNotConfirmedException') {\n                    logger.debug('the user is not confirmed');\n                    handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].ConfirmSignUp, { username: username });\n                }\n                else if (error_2.code === 'PasswordResetRequiredException') {\n                    logger.debug('the user requires a new password');\n                    handleAuthStateChange(_auth_types_78df304e_js__WEBPACK_IMPORTED_MODULE_1__[\"A\"].ForgotPassword, { username: username });\n                }\n                else if (error_2.code === 'InvalidParameterException' && password === '') {\n                    logger.debug('Password cannot be empty');\n                    error_2.message = _Translations_71acc661_js__WEBPACK_IMPORTED_MODULE_3__[\"T\"].EMPTY_PASSWORD;\n                }\n                Object(_helpers_03bb6a38_js__WEBPACK_IMPORTED_MODULE_5__[\"a\"])(error_2);\n                return [3 /*break*/, 10];\n            case 10: return [2 /*return*/];\n        }\n    });\n}); };\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGF3cy1hbXBsaWZ5L3VpLWNvbXBvbmVudHMvZGlzdC9lc20tZXM1L2F1dGgtaGVscGVycy00NDJkNGJlYS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AYXdzLWFtcGxpZnkvdWktY29tcG9uZW50cy9kaXN0L2VzbS1lczUvYXV0aC1oZWxwZXJzLTQ0MmQ0YmVhLmpzPzMwZjEiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XG4gICAgfVxufTtcbmltcG9ydCB7IExvZ2dlciwgaXNFbXB0eSB9IGZyb20gJ0Bhd3MtYW1wbGlmeS9jb3JlJztcbmltcG9ydCB7IEEgYXMgQXV0aFN0YXRlLCBDIGFzIENoYWxsZW5nZU5hbWUgfSBmcm9tICcuL2F1dGgtdHlwZXMtNzhkZjMwNGUuanMnO1xuaW1wb3J0IHsgQXV0aCB9IGZyb20gJ0Bhd3MtYW1wbGlmeS9hdXRoJztcbmltcG9ydCB7IFQgYXMgVHJhbnNsYXRpb25zIH0gZnJvbSAnLi9UcmFuc2xhdGlvbnMtNzFhY2M2NjEuanMnO1xuaW1wb3J0IHsgTiBhcyBOT19BVVRIX01PRFVMRV9GT1VORCB9IGZyb20gJy4vY29uc3RhbnRzLWQxYWJlN2RlLmpzJztcbmltcG9ydCB7IGEgYXMgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50IH0gZnJvbSAnLi9oZWxwZXJzLTAzYmI2YTM4LmpzJztcbnZhciBsb2dnZXIgPSBuZXcgTG9nZ2VyKCdhdXRoLWhlbHBlcnMnKTtcbmZ1bmN0aW9uIGNoZWNrQ29udGFjdCh1c2VyLCBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkYXRhLCBuZXdVc2VyLCBlcnJvcl8xO1xuICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIUF1dGggfHwgdHlwZW9mIEF1dGgudmVyaWZpZWRDb250YWN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9fQVVUSF9NT0RVTEVfRk9VTkQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMywgLCA0XSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGgudmVyaWZpZWRDb250YWN0KHVzZXIpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNFbXB0eShkYXRhLnZlcmlmaWVkKSB8fCBpc0VtcHR5KGRhdGEudW52ZXJpZmllZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuU2lnbmVkSW4sIHVzZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VXNlciA9IE9iamVjdC5hc3NpZ24odXNlciwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlZlcmlmeUNvbnRhY3QsIG5ld1VzZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2hUb2FzdEh1YkV2ZW50KGVycm9yXzEpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59XG52YXIgaGFuZGxlU2lnbkluID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCwgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgIHZhciB1c2VyLCBlcnJvcl8yO1xuICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGlmICghQXV0aCB8fCB0eXBlb2YgQXV0aC5zaWduSW4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKE5PX0FVVEhfTU9EVUxFX0ZPVU5EKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgOSwgLCAxMF0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGguc2lnbkluKHVzZXJuYW1lLCBwYXNzd29yZCldO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHVzZXIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKHVzZXIpO1xuICAgICAgICAgICAgICAgIGlmICghKHVzZXIuY2hhbGxlbmdlTmFtZSA9PT0gQ2hhbGxlbmdlTmFtZS5TTVNNRkEgfHwgdXNlci5jaGFsbGVuZ2VOYW1lID09PSBDaGFsbGVuZ2VOYW1lLlNvZnR3YXJlVG9rZW5NRkEpKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ2NvbmZpcm0gdXNlciB3aXRoICcgKyB1c2VyLmNoYWxsZW5nZU5hbWUpO1xuICAgICAgICAgICAgICAgIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuQ29uZmlybVNpZ25JbiwgdXNlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgaWYgKCEodXNlci5jaGFsbGVuZ2VOYW1lID09PSBDaGFsbGVuZ2VOYW1lLk5ld1Bhc3N3b3JkUmVxdWlyZWQpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3JlcXVpcmUgbmV3IHBhc3N3b3JkJywgdXNlci5jaGFsbGVuZ2VQYXJhbSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5SZXNldFBhc3N3b3JkLCB1c2VyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBpZiAoISh1c2VyLmNoYWxsZW5nZU5hbWUgPT09IENoYWxsZW5nZU5hbWUuTUZBU2V0dXApKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ1RPVFAgc2V0dXAnLCB1c2VyLmNoYWxsZW5nZVBhcmFtKTtcbiAgICAgICAgICAgICAgICBoYW5kbGVBdXRoU3RhdGVDaGFuZ2UoQXV0aFN0YXRlLlRPVFBTZXR1cCwgdXNlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgaWYgKCEodXNlci5jaGFsbGVuZ2VOYW1lID09PSBDaGFsbGVuZ2VOYW1lLkN1c3RvbUNoYWxsZW5nZSAmJlxuICAgICAgICAgICAgICAgICAgICB1c2VyLmNoYWxsZW5nZVBhcmFtICYmXG4gICAgICAgICAgICAgICAgICAgIHVzZXIuY2hhbGxlbmdlUGFyYW0udHJpZ2dlciA9PT0gJ3RydWUnKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdjdXN0b20gY2hhbGxlbmdlJywgdXNlci5jaGFsbGVuZ2VQYXJhbSk7XG4gICAgICAgICAgICAgICAgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5DdXN0b21Db25maXJtU2lnbkluLCB1c2VyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcbiAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFs0IC8qeWllbGQqLywgY2hlY2tDb250YWN0KHVzZXIsIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZSldO1xuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDg7XG4gICAgICAgICAgICBjYXNlIDg6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEwXTtcbiAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICBlcnJvcl8yID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcl8yLmNvZGUgPT09ICdVc2VyTm90Q29uZmlybWVkRXhjZXB0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3RoZSB1c2VyIGlzIG5vdCBjb25maXJtZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlQXV0aFN0YXRlQ2hhbmdlKEF1dGhTdGF0ZS5Db25maXJtU2lnblVwLCB7IHVzZXJuYW1lOiB1c2VybmFtZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3JfMi5jb2RlID09PSAnUGFzc3dvcmRSZXNldFJlcXVpcmVkRXhjZXB0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoJ3RoZSB1c2VyIHJlcXVpcmVzIGEgbmV3IHBhc3N3b3JkJyk7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUF1dGhTdGF0ZUNoYW5nZShBdXRoU3RhdGUuRm9yZ290UGFzc3dvcmQsIHsgdXNlcm5hbWU6IHVzZXJuYW1lIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChlcnJvcl8yLmNvZGUgPT09ICdJbnZhbGlkUGFyYW1ldGVyRXhjZXB0aW9uJyAmJiBwYXNzd29yZCA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdQYXNzd29yZCBjYW5ub3QgYmUgZW1wdHknKTtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JfMi5tZXNzYWdlID0gVHJhbnNsYXRpb25zLkVNUFRZX1BBU1NXT1JEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkaXNwYXRjaFRvYXN0SHViRXZlbnQoZXJyb3JfMik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xuICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICB9XG4gICAgfSk7XG59KTsgfTtcbmV4cG9ydCB7IGNoZWNrQ29udGFjdCBhcyBjLCBoYW5kbGVTaWduSW4gYXMgaCB9O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@aws-amplify/ui-components/dist/esm-es5/auth-helpers-442d4bea.js\n");

/***/ })

}]);